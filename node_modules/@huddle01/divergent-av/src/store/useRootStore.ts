import create, { GetState, SetState } from "zustand";
import { devtools } from "zustand/middleware";
import createCallerSlice from "./createCallerSlice";
import createMediaSlice from "./createMediaSlice";
import createMicSlice from "./createMicSlice";
import createUserSlice from "./createUserSlice";
import createErrorSlice from "./createErrorSlice";
import { IState } from "./storeTypes";

const createRootSlice = (set: SetState<IState>, get: GetState<IState>) => ({
  ...createCallerSlice(set, get),
  ...createMediaSlice(set, get),
  ...createMicSlice(set, get),
  ...createUserSlice(set, get),
  ...createErrorSlice(set, get),
});

const useDivergentStore = create(
  devtools(createRootSlice, {
    name: "divergent-client",
    anonymousActionType: "action",
  })
);

const { getState, setState } = useDivergentStore;

export { getState, setState };

export default useDivergentStore;
