"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("pages/_app",{

/***/ "./pages/_app.tsx":
/*!************************!*\
  !*** ./pages/_app.tsx ***!
  \************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ App; }\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"./node_modules/react/jsx-dev-runtime.js\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _styles_globals_css__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../styles/globals.css */ \"./styles/globals.css\");\n/* harmony import */ var _styles_globals_css__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_styles_globals_css__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _rainbow_me_rainbowkit_styles_css__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @rainbow-me/rainbowkit/styles.css */ \"./node_modules/@rainbow-me/rainbowkit/dist/index.css\");\n/* harmony import */ var _rainbow_me_rainbowkit_styles_css__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_rainbow_me_rainbowkit_styles_css__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _rainbow_me_rainbowkit__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @rainbow-me/rainbowkit */ \"./node_modules/@rainbow-me/rainbowkit/dist/index.js\");\n/* harmony import */ var wagmi__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! wagmi */ \"./node_modules/wagmi/dist/index.js\");\n/* harmony import */ var wagmi_providers_public__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! wagmi/providers/public */ \"./node_modules/wagmi/dist/providers/public.js\");\n/* harmony import */ var _huddle01_divergent_av__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @huddle01/divergent-av */ \"./node_modules/@huddle01/divergent-av/dist/index.mjs\");\n\n\n\n\n\n\n\nconst { chains , provider  } = (0,wagmi__WEBPACK_IMPORTED_MODULE_4__.configureChains)([\n    wagmi__WEBPACK_IMPORTED_MODULE_4__.chain.mainnet,\n    wagmi__WEBPACK_IMPORTED_MODULE_4__.chain.goerli,\n    wagmi__WEBPACK_IMPORTED_MODULE_4__.chain.polygon,\n    wagmi__WEBPACK_IMPORTED_MODULE_4__.chain.optimism,\n    wagmi__WEBPACK_IMPORTED_MODULE_4__.chain.arbitrum,\n    wagmi__WEBPACK_IMPORTED_MODULE_4__.chain.hardhat\n], [\n    // alchemyProvider({ apiKey: process.env.ALCHEMY_ID }),\n    (0,wagmi_providers_public__WEBPACK_IMPORTED_MODULE_5__.publicProvider)()\n]);\nconst { connectors  } = (0,_rainbow_me_rainbowkit__WEBPACK_IMPORTED_MODULE_6__.getDefaultWallets)({\n    appName: \"My RainbowKit App\",\n    chains\n});\nconst wagmiClient = (0,wagmi__WEBPACK_IMPORTED_MODULE_4__.createClient)({\n    autoConnect: false,\n    connectors,\n    provider\n});\nconst divergentAVClient = (0,_huddle01_divergent_av__WEBPACK_IMPORTED_MODULE_3__.getDivergentAVClient)(\"https://dg-devnet.huddle01.com\");\nfunction App(param) {\n    let { Component , pageProps  } = param;\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(wagmi__WEBPACK_IMPORTED_MODULE_4__.WagmiConfig, {\n        client: wagmiClient,\n        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_rainbow_me_rainbowkit__WEBPACK_IMPORTED_MODULE_6__.RainbowKitProvider, {\n            theme: (0,_rainbow_me_rainbowkit__WEBPACK_IMPORTED_MODULE_6__.darkTheme)(),\n            chains: chains,\n            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_huddle01_divergent_av__WEBPACK_IMPORTED_MODULE_3__.DivergentAVClientProvider, {\n                value: divergentAVClient,\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(Component, {\n                    ...pageProps\n                }, void 0, false, {\n                    fileName: \"C:\\\\Users\\\\hp\\\\Desktop\\\\patrix-1.0.0\\\\codes\\\\huddle-divergent\\\\pages\\\\_app.tsx\",\n                    lineNumber: 39,\n                    columnNumber: 11\n                }, this)\n            }, void 0, false, {\n                fileName: \"C:\\\\Users\\\\hp\\\\Desktop\\\\patrix-1.0.0\\\\codes\\\\huddle-divergent\\\\pages\\\\_app.tsx\",\n                lineNumber: 38,\n                columnNumber: 7\n            }, this)\n        }, void 0, false, {\n            fileName: \"C:\\\\Users\\\\hp\\\\Desktop\\\\patrix-1.0.0\\\\codes\\\\huddle-divergent\\\\pages\\\\_app.tsx\",\n            lineNumber: 37,\n            columnNumber: 7\n        }, this)\n    }, void 0, false, {\n        fileName: \"C:\\\\Users\\\\hp\\\\Desktop\\\\patrix-1.0.0\\\\codes\\\\huddle-divergent\\\\pages\\\\_app.tsx\",\n        lineNumber: 36,\n        columnNumber: 5\n    }, this);\n}\n_c = App;\nvar _c;\n$RefreshReg$(_c, \"App\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevExports = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevExports) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports on update so we can compare the boundary\n                // signatures.\n                module.hot.dispose(function (data) {\n                    data.prevExports = currentExports;\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevExports !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevExports, currentExports)) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevExports !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wYWdlcy9fYXBwLnRzeC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBO0FBQThCO0FBR2E7QUFDK0M7QUFDaEI7QUFFbEI7QUFDaUM7QUFHekYsTUFBTSxFQUFFVSxPQUFNLEVBQUVDLFNBQVEsRUFBRSxHQUFHUCxzREFBZUEsQ0FDMUM7SUFBQ0QsZ0RBQWE7SUFBRUEsK0NBQVk7SUFBRUEsZ0RBQWE7SUFBRUEsaURBQWM7SUFBRUEsaURBQWM7SUFBRUEsZ0RBQWE7Q0FBQyxFQUMzRjtJQUNFLHVEQUF1RDtJQUN2REksc0VBQWNBO0NBQ2Y7QUFHSCxNQUFNLEVBQUVXLFdBQVUsRUFBRSxHQUFHbEIseUVBQWlCQSxDQUFDO0lBQ3ZDbUIsU0FBUztJQUNUVDtBQUNGO0FBRUEsTUFBTVUsY0FBY2YsbURBQVlBLENBQUM7SUFDL0JnQixhQUFhLEtBQUs7SUFDbEJIO0lBQ0FQO0FBQ0Y7QUFFQSxNQUFNVyxvQkFBb0JiLDRFQUFvQkEsQ0FBQztBQUdoQyxTQUFTYyxJQUFJLEtBQWtDLEVBQUU7UUFBcEMsRUFBRUMsVUFBUyxFQUFFQyxVQUFTLEVBQVksR0FBbEM7SUFDMUIscUJBQ0UsOERBQUNuQiw4Q0FBV0E7UUFBQ29CLFFBQVFOO2tCQUNuQiw0RUFBQ25CLHNFQUFrQkE7WUFBQzBCLE9BQU96QixpRUFBU0E7WUFBSVEsUUFBUUE7c0JBQ2hELDRFQUFDRiw2RUFBeUJBO2dCQUFDb0IsT0FBT047MEJBQzlCLDRFQUFDRTtvQkFBVyxHQUFHQyxTQUFTOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFLbEMsQ0FBQztLQVZ1QkYiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vcGFnZXMvX2FwcC50c3g/MmZiZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgJy4uL3N0eWxlcy9nbG9iYWxzLmNzcydcclxuaW1wb3J0IHR5cGUgeyBBcHBQcm9wcyB9IGZyb20gJ25leHQvYXBwJ1xyXG5cclxuaW1wb3J0ICdAcmFpbmJvdy1tZS9yYWluYm93a2l0L3N0eWxlcy5jc3MnO1xyXG5pbXBvcnQgeyBnZXREZWZhdWx0V2FsbGV0cywgUmFpbmJvd0tpdFByb3ZpZGVyLCBkYXJrVGhlbWUgfSBmcm9tICdAcmFpbmJvdy1tZS9yYWluYm93a2l0JztcclxuaW1wb3J0IHsgY2hhaW4sIGNvbmZpZ3VyZUNoYWlucywgY3JlYXRlQ2xpZW50LCBXYWdtaUNvbmZpZyB9IGZyb20gJ3dhZ21pJztcclxuaW1wb3J0IHsgYWxjaGVteVByb3ZpZGVyIH0gZnJvbSAnd2FnbWkvcHJvdmlkZXJzL2FsY2hlbXknO1xyXG5pbXBvcnQgeyBwdWJsaWNQcm92aWRlciB9IGZyb20gJ3dhZ21pL3Byb3ZpZGVycy9wdWJsaWMnO1xyXG5pbXBvcnQgeyBEaXZlcmdlbnRBVkNsaWVudFByb3ZpZGVyLCBnZXREaXZlcmdlbnRBVkNsaWVudCB9IGZyb20gXCJAaHVkZGxlMDEvZGl2ZXJnZW50LWF2XCI7XHJcblxyXG5cclxuY29uc3QgeyBjaGFpbnMsIHByb3ZpZGVyIH0gPSBjb25maWd1cmVDaGFpbnMoXHJcbiAgW2NoYWluLm1haW5uZXQsIGNoYWluLmdvZXJsaSwgY2hhaW4ucG9seWdvbiwgY2hhaW4ub3B0aW1pc20sIGNoYWluLmFyYml0cnVtLCBjaGFpbi5oYXJkaGF0XSxcclxuICBbXHJcbiAgICAvLyBhbGNoZW15UHJvdmlkZXIoeyBhcGlLZXk6IHByb2Nlc3MuZW52LkFMQ0hFTVlfSUQgfSksXHJcbiAgICBwdWJsaWNQcm92aWRlcigpXHJcbiAgXVxyXG4pO1xyXG5cclxuY29uc3QgeyBjb25uZWN0b3JzIH0gPSBnZXREZWZhdWx0V2FsbGV0cyh7XHJcbiAgYXBwTmFtZTogJ015IFJhaW5ib3dLaXQgQXBwJyxcclxuICBjaGFpbnNcclxufSk7XHJcblxyXG5jb25zdCB3YWdtaUNsaWVudCA9IGNyZWF0ZUNsaWVudCh7XHJcbiAgYXV0b0Nvbm5lY3Q6IGZhbHNlLFxyXG4gIGNvbm5lY3RvcnMsXHJcbiAgcHJvdmlkZXJcclxufSlcclxuXHJcbmNvbnN0IGRpdmVyZ2VudEFWQ2xpZW50ID0gZ2V0RGl2ZXJnZW50QVZDbGllbnQoXCJodHRwczovL2RnLWRldm5ldC5odWRkbGUwMS5jb21cIik7XHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQXBwKHsgQ29tcG9uZW50LCBwYWdlUHJvcHMgfTogQXBwUHJvcHMpIHtcclxuICByZXR1cm4gKFxyXG4gICAgPFdhZ21pQ29uZmlnIGNsaWVudD17d2FnbWlDbGllbnR9PlxyXG4gICAgICA8UmFpbmJvd0tpdFByb3ZpZGVyIHRoZW1lPXtkYXJrVGhlbWUoKX0gY2hhaW5zPXtjaGFpbnN9PlxyXG4gICAgICA8RGl2ZXJnZW50QVZDbGllbnRQcm92aWRlciB2YWx1ZT17ZGl2ZXJnZW50QVZDbGllbnR9PlxyXG4gICAgICAgICAgPENvbXBvbmVudCB7Li4ucGFnZVByb3BzfSAvPlxyXG4gICAgICAgICAgPC9EaXZlcmdlbnRBVkNsaWVudFByb3ZpZGVyPlxyXG4gICAgICA8L1JhaW5ib3dLaXRQcm92aWRlcj5cclxuICAgIDwvV2FnbWlDb25maWc+XHJcbiAgKVxyXG59XHJcbiJdLCJuYW1lcyI6WyJnZXREZWZhdWx0V2FsbGV0cyIsIlJhaW5ib3dLaXRQcm92aWRlciIsImRhcmtUaGVtZSIsImNoYWluIiwiY29uZmlndXJlQ2hhaW5zIiwiY3JlYXRlQ2xpZW50IiwiV2FnbWlDb25maWciLCJwdWJsaWNQcm92aWRlciIsIkRpdmVyZ2VudEFWQ2xpZW50UHJvdmlkZXIiLCJnZXREaXZlcmdlbnRBVkNsaWVudCIsImNoYWlucyIsInByb3ZpZGVyIiwibWFpbm5ldCIsImdvZXJsaSIsInBvbHlnb24iLCJvcHRpbWlzbSIsImFyYml0cnVtIiwiaGFyZGhhdCIsImNvbm5lY3RvcnMiLCJhcHBOYW1lIiwid2FnbWlDbGllbnQiLCJhdXRvQ29ubmVjdCIsImRpdmVyZ2VudEFWQ2xpZW50IiwiQXBwIiwiQ29tcG9uZW50IiwicGFnZVByb3BzIiwiY2xpZW50IiwidGhlbWUiLCJ2YWx1ZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./pages/_app.tsx\n"));

/***/ }),

/***/ "./node_modules/@huddle01/divergent-av/dist/index.mjs":
/*!************************************************************!*\
  !*** ./node_modules/@huddle01/divergent-av/dist/index.mjs ***!
  \************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"DivergentAVClientProvider\": function() { return /* binding */ DivergentAVClient_default2; },\n/* harmony export */   \"createDivergentAVClient\": function() { return /* binding */ createDivergentAVClient; },\n/* harmony export */   \"getDivergentAVClient\": function() { return /* binding */ getDivergentAVClient; },\n/* harmony export */   \"useDivergentAVClient\": function() { return /* binding */ useDivergentAVClient; },\n/* harmony export */   \"useDivergentStore\": function() { return /* binding */ useRootStore_default; }\n/* harmony export */ });\n/* harmony import */ var zustand__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zustand */ \"./node_modules/zustand/esm/index.js\");\n/* harmony import */ var zustand_middleware__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zustand/middleware */ \"./node_modules/zustand/esm/middleware.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var socket_io_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! socket.io-client */ \"./node_modules/socket.io-client/build/esm/index.js\");\n/* harmony import */ var simple_peer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! simple-peer */ \"./node_modules/simple-peer/index.js\");\n/* harmony import */ var pino__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! pino */ \"./node_modules/pino/browser.js\");\n/* harmony import */ var tweetnacl__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! tweetnacl */ \"./node_modules/tweetnacl/nacl-fast.js\");\n/* harmony import */ var ed2curve__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ed2curve */ \"./node_modules/ed2curve/ed2curve.js\");\n/* harmony import */ var tweetnacl_util__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! tweetnacl-util */ \"./node_modules/tweetnacl-util/nacl-util.js\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! axios */ \"./node_modules/axios/index.js\");\n/* harmony import */ var ethers__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ethers */ \"./node_modules/ethers/lib.esm/index.js\");\n/* provided dependency */ var Buffer = __webpack_require__(/*! buffer */ \"./node_modules/buffer/index.js\")[\"Buffer\"];\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __async = (__this, __arguments, generator) => {\n  return new Promise((resolve, reject) => {\n    var fulfilled = (value) => {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var rejected = (value) => {\n      try {\n        step(generator.throw(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);\n    step((generator = generator.apply(__this, __arguments)).next());\n  });\n};\n\n// src/store/useRootStore.ts\n\n\n\n// src/store/createCallerSlice.ts\nvar createCallerSlice = (set) => ({\n  callerUid: void 0,\n  callerSignal: \"\",\n  callerStream: null,\n  connection: null,\n  setCallerUid: (callerUid) => set(() => ({ callerUid })),\n  setCallerSignal: (callerSignal) => set(() => ({ callerSignal })),\n  setCallerStream: (callerStream) => set(() => ({ callerStream })),\n  setConnection: (peer) => set(() => ({ connection: peer }))\n});\nvar createCallerSlice_default = createCallerSlice;\n\n// src/store/createMediaSlice.ts\nvar createMediaSlice = (set, get) => ({\n  mediaDevice: void 0,\n  stream: void 0,\n  streamError: void 0,\n  deviceLoading: true,\n  streamsArry: [],\n  enableStream: () => __async(void 0, null, function* () {\n    var _a;\n    if (get().stream) {\n      console.error({\n        type: \"error\",\n        msg: \"createMediaSlice.enableStream() | No stream\"\n      });\n      return;\n    }\n    const deviceEnabledConstrains = {\n      video: {\n        width: { ideal: 1280 },\n        height: { ideal: 720 },\n        deviceId: (_a = get().mediaDevice) == null ? void 0 : _a.deviceId\n      }\n    };\n    yield navigator.mediaDevices.getUserMedia(deviceEnabledConstrains).then((_stream) => {\n      const _newStreamArray = [...get().streamsArry, _stream];\n      set(() => ({\n        stream: _stream,\n        deviceLoading: false,\n        streamsArry: _newStreamArray\n      }));\n    }).catch((_error) => {\n      set(() => ({\n        streamError: {\n          type: _error.name,\n          blocked: true\n        },\n        deviceLoading: false\n      }));\n    });\n    if (!get().mediaDevice) {\n      const mediaDevices = yield get().getMediaDevices();\n      console.info({ mediaDevices });\n      get().setMediaDevice(mediaDevices[0]);\n    }\n  }),\n  getMediaDevices: () => __async(void 0, null, function* () {\n    const { setStreamError } = get();\n    try {\n      const mediaDevices = yield navigator.mediaDevices.enumerateDevices();\n      const devices = mediaDevices.filter(({ kind }) => kind === \"videoinput\");\n      return devices;\n    } catch (err) {\n      setStreamError(err == null ? void 0 : err.name);\n      return [];\n    }\n  }),\n  setMediaDevice: (device) => {\n    set(() => ({\n      mediaDevice: device\n    }));\n    console.info(\"set\");\n  },\n  switchMediaStream: (stream) => {\n    console.info({\n      type: \"info\",\n      msg: \"switchMediaStream() | Switching media stream\"\n    });\n    if (!stream) {\n      console.info({\n        type: \"info\",\n        msg: \"switchMediaStream() | No stream Found using default Stream\"\n      });\n      return;\n    }\n    get().pauseTracks();\n    get().setMediaStream(stream);\n  },\n  setMediaStream: (stream) => {\n    console.info({\n      type: \"info\",\n      msg: \"setMediaStream() | Setting media stream\",\n      stream\n    });\n    set(() => ({ stream }));\n  },\n  pauseTracks: () => {\n    const { stream } = get();\n    if (!stream)\n      return;\n    get().streamsArry.forEach((stream2) => {\n      stream2.getTracks().forEach((track) => {\n        track.stop();\n      });\n    });\n    stream.getTracks().forEach((track) => track.stop());\n    set(() => ({ stream: void 0, streamsArry: [] }));\n  },\n  setDeviceLoading: (loading) => {\n    set(() => ({ deviceLoading: loading }));\n  },\n  setStreamError: (error) => {\n    set(() => ({\n      streamError: {\n        type: error || \"UnknownError\",\n        blocked: error === \"NotAllowedError\"\n      }\n    }));\n  }\n});\nvar createMediaSlice_default = createMediaSlice;\n\n// src/store/createMicSlice.ts\nvar createMicSlice = (set, get) => ({\n  micState: {\n    mediaDevice: void 0,\n    stream: void 0,\n    streamError: null,\n    deviceLoading: true\n  },\n  enableAudioStream: () => __async(void 0, null, function* () {\n    var _a;\n    if (get().micState.stream) {\n      console.error({\n        type: \"error\",\n        msg: \"createMediaSlice.enableStream() | No stream\"\n      });\n      return;\n    }\n    const deviceEnabledConstrains = {\n      audio: {\n        deviceId: (_a = get().micState.mediaDevice) == null ? void 0 : _a.deviceId\n      }\n    };\n    console.info(\"Enabling new Mic stream\");\n    yield navigator.mediaDevices.getUserMedia(deviceEnabledConstrains).then((_stream) => {\n      set(() => ({\n        micState: __spreadProps(__spreadValues({}, get().micState), {\n          stream: _stream,\n          deviceLoading: false\n        })\n      }));\n    }).catch((_error) => {\n      set(() => ({\n        micState: __spreadProps(__spreadValues({}, get().micState), {\n          streamError: {\n            type: _error.name,\n            blocked: _error.name === \"NotAllowedError\"\n          },\n          deviceLoading: false\n        })\n      }));\n    });\n    if (!get().micState.mediaDevice) {\n      const audioDevices = yield get().getAudioDevices();\n      console.info({ audioDevices });\n      get().setAudioDevice(audioDevices[0]);\n    }\n  }),\n  getAudioDevices: () => __async(void 0, null, function* () {\n    const { setAudioStreamError } = get();\n    try {\n      const mediaDevices = yield navigator.mediaDevices.enumerateDevices();\n      const devices = mediaDevices.filter(({ kind }) => kind === \"audioinput\");\n      return devices;\n    } catch (err) {\n      setAudioStreamError(err == null ? void 0 : err.name);\n      return [];\n    }\n  }),\n  setAudioDevice: (device) => {\n    set(() => ({\n      micState: __spreadProps(__spreadValues({}, get().micState), {\n        mediaDevice: device\n      })\n    }));\n  },\n  switchAudioStream: (stream) => {\n    console.info({\n      type: \"info\",\n      msg: \"switchAudioStream() | Switching A stream\"\n    });\n    if (!stream) {\n      console.info({\n        type: \"info\",\n        msg: \"switchAudioStream() | No stream Found using default Stream\"\n      });\n      return;\n    }\n    get().pauseAudioTracks();\n    get().setAudioStream(stream);\n  },\n  setAudioStream: (stream) => {\n    console.info({\n      type: \"info\",\n      msg: \"setAudioStream() | Setting Audio stream\",\n      stream\n    });\n    set(() => ({\n      micState: __spreadProps(__spreadValues({}, get().micState), {\n        stream\n      })\n    }));\n  },\n  pauseAudioTracks: () => {\n    const { stream } = get().micState;\n    if (!stream)\n      return;\n    console.info({\n      type: \"info\",\n      msg: \"pauseAudioTracks() | Pausing Audio stream\"\n    });\n    stream.getTracks().forEach((track) => track.stop());\n    set(() => ({ micState: __spreadProps(__spreadValues({}, get().micState), { stream: void 0 }) }));\n  },\n  setAudioDeviceLoading: (loading) => {\n    set(() => ({ micState: __spreadProps(__spreadValues({}, get().micState), { deviceLoading: loading }) }));\n  },\n  setAudioStreamError: (error) => {\n    set(() => ({\n      micState: __spreadProps(__spreadValues({}, get().micState), {\n        streamError: {\n          type: error || \"UnknownError\",\n          blocked: error === \"NotAllowedError\"\n        }\n      })\n    }));\n  }\n});\nvar createMicSlice_default = createMicSlice;\n\n// src/store/createUserSlice.ts\nvar createUserSlice = (set, get) => ({\n  user: {\n    uid: \"\",\n    socket: \"\",\n    node: \"\",\n    avatarUrl: \"\",\n    messages: []\n  },\n  connection: null,\n  peer: null,\n  conversations: {},\n  groups: {},\n  syncMessages: [],\n  incorrectKeys: false,\n  setUser: (user) => set(() => ({ user })),\n  setPeer: (peer) => set(() => ({ peer })),\n  setConnection: (peer) => set(() => ({ connection: peer }))\n});\nvar createUserSlice_default = createUserSlice;\n\n// src/store/createErrorSlice.ts\nvar createErrorSlice = (set) => ({\n  errorType: null,\n  errorMessage: void 0,\n  setError: (type, msg) => set(() => ({ errorType: type, errorMessage: msg })),\n  resetError: () => set(() => ({ errorType: null, errorMessage: void 0 }))\n});\nvar createErrorSlice_default = createErrorSlice;\n\n// src/store/useRootStore.ts\nvar createRootSlice = (set, get) => __spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues({}, createCallerSlice_default(set, get)), createMediaSlice_default(set, get)), createMicSlice_default(set, get)), createUserSlice_default(set, get)), createErrorSlice_default(set, get));\nvar useDivergentStore = (0,zustand__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(\n  (0,zustand_middleware__WEBPACK_IMPORTED_MODULE_1__.devtools)(createRootSlice, {\n    name: \"divergent-client\",\n    anonymousActionType: \"action\"\n  })\n);\nvar { getState, setState } = useDivergentStore;\nvar useRootStore_default = useDivergentStore;\n\n// src/DivergentAVClient/index.tsx\n\n\n// src/DivergentAVClient/context.ts\n\nvar DivergentAVClientContext = (0,react__WEBPACK_IMPORTED_MODULE_2__.createContext)(\n  {}\n);\n\n// src/DivergentAVClient/DivergentAVClient.ts\n\n\n\n// src/DivergentAVClient/utils/logger.ts\n\nvar logger = pino__WEBPACK_IMPORTED_MODULE_5__({\n  browser: { asObject: false },\n  enabled: true\n});\nvar logger_default = logger;\n\n// src/DivergentAVClient/utils/Verner/verner.ts\n\n\n// src/DivergentAVClient/utils/Verner/verner-utils.ts\n\n\nvar vernerUtils = {\n  convertPublicKey: (publicKey) => {\n    const pk = ed2curve__WEBPACK_IMPORTED_MODULE_7__.convertPublicKey(publicKey);\n    if (pk)\n      return pk;\n    else\n      return new Uint8Array();\n  },\n  convertSecretKey: (secretKey) => {\n    return ed2curve__WEBPACK_IMPORTED_MODULE_7__.convertSecretKey(secretKey);\n  },\n  hexToUint8: (string) => {\n    return Uint8Array.from(Buffer.from(string, \"hex\"));\n  },\n  uint8ToHex: (uint8array) => {\n    return Buffer.from(uint8array).toString(\"hex\");\n  },\n  strToUtf8: (str) => {\n    console.log(str);\n    return tweetnacl_util__WEBPACK_IMPORTED_MODULE_8__.decodeUTF8(str);\n  },\n  utf8ToStr: (uint8) => {\n    return tweetnacl_util__WEBPACK_IMPORTED_MODULE_8__.encodeUTF8(uint8);\n  },\n  uint8toBase64: (uint8) => {\n    return tweetnacl_util__WEBPACK_IMPORTED_MODULE_8__.encodeBase64(uint8);\n  },\n  base64ToUint8: (str) => {\n    return tweetnacl_util__WEBPACK_IMPORTED_MODULE_8__.decodeBase64(str);\n  }\n};\nvar verner_utils_default = vernerUtils;\n\n// src/DivergentAVClient/utils/Verner/verner.ts\nvar Verner = {\n  generateKeys: (uid) => {\n    return new Promise((resolve, reject) => {\n      try {\n        const ks = tweetnacl__WEBPACK_IMPORTED_MODULE_6__.sign.keyPair();\n        const publicKey = verner_utils_default.uint8ToHex(ks.publicKey);\n        const secretKey = verner_utils_default.uint8ToHex(ks.secretKey);\n        resolve({ publicKey, secretKey });\n      } catch (e) {\n        reject(e);\n      }\n    });\n  },\n  getSigningKeys: (publicKey, secretKey) => {\n    return new Promise((resolve, reject) => {\n      try {\n        const keypair = tweetnacl__WEBPACK_IMPORTED_MODULE_6__.sign.keyPair();\n        const pk = verner_utils_default.hexToUint8(publicKey);\n        const sk = verner_utils_default.hexToUint8(secretKey);\n        keypair.publicKey = pk;\n        keypair.secretKey = sk;\n        resolve(keypair);\n      } catch (e) {\n        reject(e);\n      }\n    });\n  },\n  encryptMessage: (message, nonce, participantPublicKey, selfSecretKey) => {\n    return new Promise((resolve, reject) => {\n      try {\n        const utf8Message = verner_utils_default.strToUtf8(message);\n        const uint8Nonce = verner_utils_default.hexToUint8(nonce);\n        const uint8ppk = verner_utils_default.hexToUint8(participantPublicKey);\n        const uint8spk = verner_utils_default.hexToUint8(selfSecretKey);\n        const curve25519publicKey = verner_utils_default.convertPublicKey(uint8ppk);\n        const curver25519secretKey = verner_utils_default.convertSecretKey(uint8spk);\n        const encryptedMessage = tweetnacl__WEBPACK_IMPORTED_MODULE_6__.box(\n          utf8Message,\n          uint8Nonce,\n          curve25519publicKey,\n          curver25519secretKey\n        );\n        const encryptedMsgStr = verner_utils_default.uint8toBase64(encryptedMessage);\n        resolve(encryptedMsgStr);\n      } catch (e) {\n        reject(e);\n      }\n    });\n  },\n  decryptMessage: (encryptedMessage, nonce, participantPublicKey, selfSecretKey) => {\n    return new Promise((resolve, reject) => {\n      try {\n        const utf8EncryptedMessage = verner_utils_default.base64ToUint8(encryptedMessage);\n        const uint8Nonce = verner_utils_default.hexToUint8(nonce);\n        const uint8ppk = verner_utils_default.hexToUint8(participantPublicKey);\n        const uint8spk = verner_utils_default.hexToUint8(selfSecretKey);\n        const curve25519publicKey = verner_utils_default.convertPublicKey(uint8ppk);\n        const curver25519secretKey = verner_utils_default.convertSecretKey(uint8spk);\n        const decryptedMessage = tweetnacl__WEBPACK_IMPORTED_MODULE_6__.box.open(\n          utf8EncryptedMessage,\n          uint8Nonce,\n          curve25519publicKey,\n          curver25519secretKey\n        );\n        const decryptedMsgStr = verner_utils_default.utf8ToStr(\n          decryptedMessage\n        );\n        resolve(decryptedMsgStr);\n      } catch (e) {\n        reject(e);\n      }\n    });\n  },\n  generateNonce: () => {\n    return new Promise((resolve, reject) => {\n      try {\n        const nonceHexStr = [...Array(48)].map(() => Math.floor(Math.random() * 16).toString(16)).join(\"\");\n        resolve(nonceHexStr);\n      } catch (e) {\n        reject(e);\n      }\n    });\n  }\n};\nvar verner_default = Verner;\n\n// src/DivergentAVClient/DivergentAVClient.ts\n\n\n\n// src/DivergentAVClient/utils/auth/auth.ts\n\nvar walletAuth = {\n  _generateSignatureMessage: (walletAddress) => __async(void 0, null, function* () {\n    const identityProviderResponse = yield axios__WEBPACK_IMPORTED_MODULE_9__[\"default\"].get(\n      `https://api.identity.testing.huddle01.com/sign-message?address=${walletAddress}`\n    );\n    return identityProviderResponse.data.message;\n  }),\n  verifySignature: (walletAddress, signMessage, signature) => __async(void 0, null, function* () {\n    const apiResponse = yield axios__WEBPACK_IMPORTED_MODULE_9__[\"default\"].post(\n      \"https://api.identity.testing.huddle01.com/login\",\n      {\n        address: walletAddress,\n        signature,\n        message: signMessage,\n        walletType: \"ethereum\",\n        platformOrigin: \"web-platform\"\n      }\n    );\n    return apiResponse.data;\n  })\n};\nvar lensAuth = {\n  getSignatureMessage: (address) => __async(void 0, null, function* () {\n    const apiResponse = yield axios__WEBPACK_IMPORTED_MODULE_9__[\"default\"].post(\"https://api.lens.dev\", {\n      query: `query Challenge($address: EthereumAddress!) {\n              challenge(request: { address: $address }) {\n              text\n            }\n        }`,\n      variables: {\n        address\n      }\n    });\n    return apiResponse.data.data.challenge.text;\n  }),\n  getTokens: (address, signature) => __async(void 0, null, function* () {\n    const apiResponse = yield axios__WEBPACK_IMPORTED_MODULE_9__[\"default\"].post(\n      \"https://api.identity.testing.huddle01.com/login-did\",\n      {\n        didAccessToken: signature,\n        address,\n        walletType: \"lens\",\n        platformOrigin: \"web-platform\"\n      }\n    );\n    return apiResponse.data;\n  }),\n  getHandle: (address) => __async(void 0, null, function* () {\n    const apiResponse = yield axios__WEBPACK_IMPORTED_MODULE_9__[\"default\"].post(\"https://api.lens.dev\", {\n      query: `query Profiles($address: EthereumAddress!) {\n       profiles(request: { ownedBy: [$address], limit: 10 }) {\n         items {\n           id\n           name\n           handle\n         }\n       }\n     }`,\n      variables: {\n        address\n      }\n    });\n    return apiResponse.data.data.profiles.items[0].handle;\n  })\n};\n\n// src/DivergentAVClient/utils/KMSUtils.ts\nvar KMSUtils = {\n  generateIdentityKey: () => __async(void 0, null, function* () {\n    let key = yield window.crypto.subtle.generateKey(\n      {\n        name: \"AES-GCM\",\n        length: 256\n      },\n      true,\n      [\"encrypt\", \"decrypt\"]\n    );\n    const rawKeyBuf = yield window.crypto.subtle.exportKey(\"raw\", key);\n    const rawKeyArr = new Uint8Array(rawKeyBuf);\n    return Buffer.from(rawKeyArr).toString(\"hex\");\n  }),\n  aesGcmEncrypt: (secretKey, signature) => __async(void 0, null, function* () {\n    const pwUtf8 = new TextEncoder().encode(signature);\n    const pwHash = yield window.crypto.subtle.digest(\"SHA-256\", pwUtf8);\n    const iv = yield window.crypto.getRandomValues(new Uint8Array(12));\n    const ivStr = Array.from(iv).map((b) => String.fromCharCode(b)).join(\"\");\n    const alg = { name: \"AES-GCM\", iv };\n    const key = yield window.crypto.subtle.importKey(\n      \"raw\",\n      pwHash,\n      alg,\n      false,\n      [\"encrypt\"]\n    );\n    const ptUint8 = new TextEncoder().encode(secretKey);\n    const ctBuffer = yield window.crypto.subtle.encrypt(alg, key, ptUint8);\n    const ctArray = Array.from(new Uint8Array(ctBuffer));\n    const ctStr = ctArray.map((byte) => String.fromCharCode(byte)).join(\"\");\n    return btoa(ivStr + ctStr);\n  }),\n  aesGcmDecrypt: (cipherKey, signature) => __async(void 0, null, function* () {\n    const pwUtf8 = new TextEncoder().encode(signature);\n    const pwHash = yield window.crypto.subtle.digest(\"SHA-256\", pwUtf8);\n    const ivStr = atob(cipherKey).slice(0, 12);\n    const iv = new Uint8Array(Array.from(ivStr).map((ch) => ch.charCodeAt(0)));\n    const alg = { name: \"AES-GCM\", iv };\n    const key = yield window.crypto.subtle.importKey(\n      \"raw\",\n      pwHash,\n      alg,\n      false,\n      [\"decrypt\"]\n    );\n    const ctStr = atob(cipherKey).slice(12);\n    const ctUint8 = new Uint8Array(\n      Array.from(ctStr).map((ch) => ch.charCodeAt(0))\n    );\n    try {\n      const plainBuffer = yield window.crypto.subtle.decrypt(alg, key, ctUint8);\n      return new TextDecoder().decode(plainBuffer);\n    } catch (error) {\n      throw new Error(\"decrypt failed\");\n    }\n  })\n};\nvar KMSUtils_default = KMSUtils;\n\n// src/DivergentAVClient/DivergentAVClient.ts\nvar getDivergentStore;\nvar DivergentStore = class {\n  static init(get) {\n    getDivergentStore = get;\n  }\n  getPeer() {\n    const { peer } = getDivergentStore();\n    if (!peer) {\n      logger_default.error({\n        message: \"peer is not set\",\n        meta: { peer }\n      });\n      return;\n    }\n    return peer;\n  }\n  enableAudioStream() {\n    return __async(this, null, function* () {\n      const { enableAudioStream } = getDivergentStore();\n      yield enableAudioStream();\n    });\n  }\n  disableAudioStream() {\n    return __async(this, null, function* () {\n      const { pauseAudioTracks } = getDivergentStore();\n      yield pauseAudioTracks();\n    });\n  }\n  getUser() {\n    const { user } = getDivergentStore();\n    return user;\n  }\n  getMicStream() {\n    const { micState } = getDivergentStore();\n    if (!micState.stream) {\n      logger_default.error({\n        message: \"mic stream is not set\",\n        meta: { micState }\n      });\n      return;\n    }\n    return micState.stream;\n  }\n  getCallerSignal() {\n    const { callerSignal } = getDivergentStore();\n    return callerSignal;\n  }\n  getCallerUid() {\n    const { callerUid } = getDivergentStore();\n    return callerUid;\n  }\n  setUser(user) {\n    const { setUser } = getDivergentStore();\n    setUser(user);\n  }\n  setCallerUid(uid) {\n    const { setCallerUid } = getDivergentStore();\n    setCallerUid(uid);\n  }\n  setPeer(peer) {\n    const { setPeer } = getDivergentStore();\n    setPeer(peer);\n  }\n  setCallerSignal(signal) {\n    const { setCallerSignal } = getDivergentStore();\n    setCallerSignal(signal);\n  }\n  setCallerStream(stream) {\n    const { setCallerStream } = getDivergentStore();\n    setCallerStream(stream);\n  }\n  setConnection(peer) {\n    const { setConnection } = getDivergentStore();\n    setConnection(peer);\n  }\n  setError(type, msg) {\n    const { setError } = getDivergentStore();\n    setError(type, msg);\n  }\n  resetError() {\n    const { resetError } = getDivergentStore();\n    resetError();\n  }\n};\nvar DivergentSocketClient = class extends DivergentStore {\n  constructor(rpcEndpoint) {\n    super();\n    this.rpcEndpoint = rpcEndpoint;\n    this.socket = void 0;\n  }\n};\nvar DivergentAVClient = class extends DivergentSocketClient {\n  constructor(rpcEndpoint) {\n    super(rpcEndpoint);\n    this.start = () => __async(this, null, function* () {\n      if (!this.socket) {\n        console.error(this.socket);\n        return;\n      }\n      this.socket.on(\"update-peer\", (data) => __async(this, null, function* () {\n        logger_default.info({\n          logType: `update-peer`,\n          message: `Updating peer}`,\n          meta: JSON.stringify(data)\n        });\n        this.setUser(data);\n      }));\n      this.socket.on(\"call\", (data) => {\n        logger_default.info({\n          type: `call-user`,\n          message: `Receiving call`,\n          meta: {\n            from: data.fromUid,\n            to: this.getUser().uid\n          }\n        });\n        this.setCallerUid(data.fromUid);\n        this.setCallerSignal(data.signal);\n      });\n      this.socket.on(\"end-call\", () => {\n        console.log(\"ENDING CALL\");\n        this.setConnection(null);\n        this.setPeer(null);\n        this.setCallerUid(\"\");\n        this.setCallerSignal(null);\n        this.setCallerStream(null);\n        this.disableAudioStream();\n      });\n      this.socket.on(\"error\", (data) => {\n        this.setError(data.type, data.msg);\n      });\n    });\n    this._getUserKey = (uid, type) => {\n      const opts = {\n        publicKey: (uid2) => __async(this, null, function* () {\n          const rpcResponse = yield axios__WEBPACK_IMPORTED_MODULE_9__[\"default\"].get(\n            `${this.rpcEndpoint}/public-key/${uid2}`\n          );\n          return rpcResponse.data.publicKey;\n        }),\n        secretKey: (uid2) => __async(this, null, function* () {\n          try {\n            const provider = new ethers__WEBPACK_IMPORTED_MODULE_10__.ethers.providers.Web3Provider(\n              window.ethereum\n            );\n            yield provider.send(\"eth_requestAccounts\", []);\n            const signer = yield provider.getSigner();\n            const walletAddress = yield signer.getAddress();\n            const rpcResponse1 = yield axios__WEBPACK_IMPORTED_MODULE_9__[\"default\"].get(\n              `${this.rpcEndpoint}/secret-key/${uid2}`\n            );\n            const encryptedSecretKey = rpcResponse1.data.secretKey;\n            const signatureMessageForIdentityKey = `Requesting to access your Identity Key. Nonce: ${yield verner_default.generateNonce()}`;\n            const identitySignature = yield signer.signMessage(\n              signatureMessageForIdentityKey\n            );\n            const rpcResponse2 = yield axios__WEBPACK_IMPORTED_MODULE_9__[\"default\"].get(\n              uid2 == walletAddress ? `${this.rpcEndpoint}/identity-key/${walletAddress}?signature=${identitySignature}&signatureMessage=${signatureMessageForIdentityKey}` : `${this.rpcEndpoint}/identity-key/${walletAddress}?signature=${identitySignature}&signatureMessage=${signatureMessageForIdentityKey}&uid=${uid2}`\n            );\n            const identityKey = rpcResponse2.data.identityKey;\n            const signature = yield signer.signMessage(\n              `Enable identity on Divergent: ${identityKey}`\n            );\n            const secretKey = yield KMSUtils_default.aesGcmDecrypt(\n              encryptedSecretKey,\n              signature\n            );\n            return secretKey;\n          } catch (e) {\n            this.setError(\n              \"signRejected\",\n              \"User has rejected to provide the signature.\"\n            );\n          }\n        })\n      };\n      return opts[type](uid);\n    };\n    this._loginWithWallet = () => __async(this, null, function* () {\n      try {\n        const provider = new ethers__WEBPACK_IMPORTED_MODULE_10__.ethers.providers.Web3Provider(\n          window.ethereum\n        );\n        yield provider.send(\"eth_requestAccounts\", []);\n        const signer = yield provider.getSigner();\n        const walletAddress = yield signer.getAddress();\n        const signMessage = yield walletAuth._generateSignatureMessage(\n          walletAddress\n        );\n        const signature = yield signer.signMessage(signMessage);\n        yield this._handleAuth(walletAddress, signMessage, signature);\n        return;\n      } catch (e) {\n        this.setError(\n          \"signRejected\",\n          \"User has rejected to provide the signature.\"\n        );\n      }\n    });\n    this._loginWithLens = () => __async(this, null, function* () {\n      try {\n        const provider = new ethers__WEBPACK_IMPORTED_MODULE_10__.ethers.providers.Web3Provider(\n          window.ethereum\n        );\n        yield provider.send(\"eth_requestAccounts\", []);\n        const signer = yield provider.getSigner();\n        const walletAddress = yield signer.getAddress();\n        const signatureMessage = yield lensAuth.getSignatureMessage(\n          walletAddress\n        );\n        const signature = yield signer.signMessage(signatureMessage);\n        const tokens = yield lensAuth.getTokens(walletAddress, signature);\n        const uid = yield lensAuth.getHandle(walletAddress);\n        localStorage.setItem(\n          \"lensAccessToken\",\n          JSON.stringify({\n            accessToken: tokens.lensAccessToken,\n            refreshToken: tokens.lensRefreshToken\n          })\n        );\n        this.socket = (0,socket_io_client__WEBPACK_IMPORTED_MODULE_3__.io)(this.rpcEndpoint, {\n          auth: {\n            token: tokens.accessToken\n          }\n        });\n        this.start();\n        this._handleKMSAuth(uid);\n      } catch (e) {\n        this.setError(\n          \"signRejected\",\n          \"User has rejected to provide the signature.\"\n        );\n      }\n    });\n    this._handleAuth = (uid, signMessage, signature) => __async(this, null, function* () {\n      const tokens = yield walletAuth.verifySignature(\n        uid,\n        signMessage,\n        signature\n      );\n      this.socket = (0,socket_io_client__WEBPACK_IMPORTED_MODULE_3__.io)(this.rpcEndpoint, {\n        auth: {\n          token: tokens.accessToken\n        }\n      });\n      this.start();\n      this._handleKMSAuth(uid);\n    });\n    this._handleKMSAuth = (uid) => __async(this, null, function* () {\n      try {\n        const rpcResponse = yield axios__WEBPACK_IMPORTED_MODULE_9__[\"default\"].get(`${this.rpcEndpoint}/${uid}`);\n        if (!rpcResponse.data.exists) {\n          const identityKey = yield KMSUtils_default.generateIdentityKey();\n          const provider = new ethers__WEBPACK_IMPORTED_MODULE_10__.ethers.providers.Web3Provider(\n            window.ethereum\n          );\n          yield provider.send(\"eth_requestAccounts\", []);\n          const signer = yield provider.getSigner();\n          const signature = yield signer.signMessage(\n            `Enable identity on Divergent: ${identityKey}`\n          );\n          const keys = yield verner_default.generateKeys(uid);\n          const encryptedSecretKey = yield KMSUtils_default.aesGcmEncrypt(\n            keys.secretKey,\n            signature\n          );\n          this.secretKey = keys.secretKey;\n          this.publicKey = keys.publicKey;\n          this.socket && this.socket.emit(\"@update-peer\", {\n            uid,\n            id: this.socket.id,\n            type: \"login\",\n            identityKey,\n            publicKey: keys.publicKey,\n            secretKey: encryptedSecretKey\n          });\n        } else {\n          this.secretKey = yield this._getUserKey(uid, \"secretKey\");\n          this.publicKey = yield this._getUserKey(uid, \"publicKey\");\n          this.socket && this.socket.emit(\"@update-peer\", {\n            uid,\n            id: this.socket.id,\n            type: \"login\"\n          });\n        }\n      } catch (e) {\n        this.setError(\n          \"signRejected\",\n          \"User has rejected to provide the signature.\"\n        );\n      }\n    });\n    this.init = (type) => __async(this, null, function* () {\n      logger_default.info({\n        type: \"login\",\n        message: \"Logging in user\"\n      });\n      if (type == \"wallet\")\n        yield this._loginWithWallet();\n      else if (type == \"lens\")\n        yield this._loginWithLens();\n      else\n        this._loginWithWallet();\n      return;\n    });\n    this.dial = (toId) => __async(this, null, function* () {\n      try {\n        logger_default.info({\n          type: `dial`,\n          message: `Dialing to a user`,\n          meta: {\n            to: toId,\n            from: this.getUser().uid\n          }\n        });\n        this.setCallerUid(toId);\n        yield this.enableAudioStream();\n        const peer = new simple_peer__WEBPACK_IMPORTED_MODULE_4__({\n          initiator: true,\n          trickle: false,\n          stream: this.getMicStream() ? this.getMicStream() : void 0\n        });\n        this.setPeer(peer);\n        peer.on(\"signal\", (data) => {\n          const user = this.getUser();\n          console.log(user);\n          if (!this.socket)\n            return;\n          this.socket.emit(\"@call\", {\n            peerToCall: toId,\n            signalData: data,\n            from: user.uid\n          });\n        });\n        peer.on(\"stream\", (stream) => {\n          console.log(stream);\n          this.setCallerStream(stream);\n        });\n        peer.on(\"data\", (data) => {\n          const decodedData = new TextDecoder().decode(data);\n          console.log(decodedData);\n        });\n        console.log(this.getPeer());\n        if (!this.socket)\n          return;\n        this.socket.on(\"answer\", (signal) => {\n          console.log(\"CALL ACCEPTED\", signal);\n          peer.signal(signal);\n        });\n        this.setConnection(peer);\n      } catch (e) {\n        logger_default.error({\n          type: `dial-error`,\n          message: `Unable to dial to user`,\n          meta: JSON.stringify(e)\n        });\n        return e;\n      }\n    });\n    this.answer = () => __async(this, null, function* () {\n      try {\n        logger_default.info({\n          type: `answer`,\n          messaging: `Answering call`\n        });\n        yield this.enableAudioStream();\n        const peer = new simple_peer__WEBPACK_IMPORTED_MODULE_4__({\n          initiator: false,\n          trickle: false,\n          stream: this.getMicStream() ? this.getMicStream() : void 0\n        });\n        this.setPeer(peer);\n        peer.on(\"signal\", (data) => {\n          var _a;\n          (_a = this.socket) == null ? void 0 : _a.emit(\"@answer\", {\n            signal: data,\n            to: this.getCallerUid()\n          });\n        });\n        peer.on(\"stream\", (stream) => {\n          console.log(stream);\n          this.setCallerStream(stream);\n        });\n        peer.signal(this.getCallerSignal());\n        this.setConnection(peer);\n      } catch (e) {\n        logger_default.error({\n          type: `answer-error`,\n          messaging: `Failed to answer call`,\n          meta: JSON.stringify(e)\n        });\n        return e;\n      }\n    });\n    this.end = () => {\n      var _a;\n      (_a = this.socket) == null ? void 0 : _a.emit(\"@end\", { peerToEnd: this.getCallerUid() });\n      this.setConnection(null);\n      this.setPeer(null);\n      this.setCallerUid(\"\");\n      this.setCallerSignal(null);\n      this.setCallerStream(null);\n      this.disableAudioStream();\n    };\n    this.revealKeys = () => __async(this, null, function* () {\n      const uid = this.getUser().uid;\n      const publicKey = yield this._getUserKey(uid, \"publicKey\");\n      const secretKey = yield this._getUserKey(uid, \"secretKey\");\n      const keys = { publicKey, secretKey };\n      return keys;\n    });\n  }\n};\nvar DivergentAVClient_default = DivergentAVClient;\n\n// src/DivergentAVClient/index.tsx\nvar DivergentAVClientProvider = ({ children, value }) => {\n  const { getState: getState2 } = useRootStore_default;\n  DivergentAVClient_default.init(getState2);\n  return /* @__PURE__ */ react__WEBPACK_IMPORTED_MODULE_2__.createElement(DivergentAVClientContext.Provider, { value }, \" \", children, \" \");\n};\nvar DivergentAVClient_default2 = DivergentAVClientProvider;\n\n// src/hooks/index.ts\n\nvar useDivergentAVClient = () => (0,react__WEBPACK_IMPORTED_MODULE_2__.useContext)(DivergentAVClientContext);\n\n// src/DivergentAVClient/hc.ts\nvar dc;\nvar createDivergentAVClient = (rpcEndpoint) => {\n  dc = new DivergentAVClient_default(rpcEndpoint);\n  return dc;\n};\nvar getDivergentAVClient = (rpcEndpoint) => {\n  if (!dc && rpcEndpoint)\n    createDivergentAVClient(rpcEndpoint);\n  return dc;\n};\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGh1ZGRsZTAxL2RpdmVyZ2VudC1hdi9kaXN0L2luZGV4Lm1qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhFQUE4RSw2REFBNkQ7QUFDM0k7QUFDQSwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQzZCO0FBQ2lCOztBQUU5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsV0FBVztBQUN2RCxrREFBa0QsY0FBYztBQUNoRSxrREFBa0QsY0FBYztBQUNoRSx3Q0FBd0Msa0JBQWtCO0FBQzFELENBQUM7QUFDRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixhQUFhO0FBQzlCLGtCQUFrQixZQUFZO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxxQkFBcUIsY0FBYztBQUNuQztBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsWUFBWSxpQkFBaUI7QUFDN0I7QUFDQTtBQUNBLDZDQUE2QyxNQUFNO0FBQ25EO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FB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Q0EsS0FBSztBQUNMO0FBQ0E7QUFDQSw4REFBOEQsZ0NBQWdDO0FBQzlGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0EsbUNBQW1DLGlCQUFpQjtBQUNwRCxVQUFVLHNCQUFzQjtBQUNoQztBQUNBLHlCQUF5QixnREFBbUIsc0NBQXNDLE9BQU87QUFDekY7QUFDQTs7QUFFQTtBQUNtQztBQUNuQyxpQ0FBaUMsaURBQVU7O0FBRTNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPRSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvQGh1ZGRsZTAxL2RpdmVyZ2VudC1hdi9kaXN0L2luZGV4Lm1qcz8yZWNjIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2RlZlByb3AgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG52YXIgX19kZWZQcm9wcyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzO1xudmFyIF9fZ2V0T3duUHJvcERlc2NzID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM7XG52YXIgX19nZXRPd25Qcm9wU3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7XG52YXIgX19oYXNPd25Qcm9wID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcbnZhciBfX3Byb3BJc0VudW0gPSBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlO1xudmFyIF9fZGVmTm9ybWFsUHJvcCA9IChvYmosIGtleSwgdmFsdWUpID0+IGtleSBpbiBvYmogPyBfX2RlZlByb3Aob2JqLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSwgdmFsdWUgfSkgOiBvYmpba2V5XSA9IHZhbHVlO1xudmFyIF9fc3ByZWFkVmFsdWVzID0gKGEsIGIpID0+IHtcbiAgZm9yICh2YXIgcHJvcCBpbiBiIHx8IChiID0ge30pKVxuICAgIGlmIChfX2hhc093blByb3AuY2FsbChiLCBwcm9wKSlcbiAgICAgIF9fZGVmTm9ybWFsUHJvcChhLCBwcm9wLCBiW3Byb3BdKTtcbiAgaWYgKF9fZ2V0T3duUHJvcFN5bWJvbHMpXG4gICAgZm9yICh2YXIgcHJvcCBvZiBfX2dldE93blByb3BTeW1ib2xzKGIpKSB7XG4gICAgICBpZiAoX19wcm9wSXNFbnVtLmNhbGwoYiwgcHJvcCkpXG4gICAgICAgIF9fZGVmTm9ybWFsUHJvcChhLCBwcm9wLCBiW3Byb3BdKTtcbiAgICB9XG4gIHJldHVybiBhO1xufTtcbnZhciBfX3NwcmVhZFByb3BzID0gKGEsIGIpID0+IF9fZGVmUHJvcHMoYSwgX19nZXRPd25Qcm9wRGVzY3MoYikpO1xudmFyIF9fYXN5bmMgPSAoX190aGlzLCBfX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSA9PiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgdmFyIGZ1bGZpbGxlZCA9ICh2YWx1ZSkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZWplY3QoZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgcmVqZWN0ZWQgPSAodmFsdWUpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHN0ZXAoZ2VuZXJhdG9yLnRocm93KHZhbHVlKSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJlamVjdChlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHZhciBzdGVwID0gKHgpID0+IHguZG9uZSA/IHJlc29sdmUoeC52YWx1ZSkgOiBQcm9taXNlLnJlc29sdmUoeC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTtcbiAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkoX190aGlzLCBfX2FyZ3VtZW50cykpLm5leHQoKSk7XG4gIH0pO1xufTtcblxuLy8gc3JjL3N0b3JlL3VzZVJvb3RTdG9yZS50c1xuaW1wb3J0IGNyZWF0ZSBmcm9tIFwienVzdGFuZFwiO1xuaW1wb3J0IHsgZGV2dG9vbHMgfSBmcm9tIFwienVzdGFuZC9taWRkbGV3YXJlXCI7XG5cbi8vIHNyYy9zdG9yZS9jcmVhdGVDYWxsZXJTbGljZS50c1xudmFyIGNyZWF0ZUNhbGxlclNsaWNlID0gKHNldCkgPT4gKHtcbiAgY2FsbGVyVWlkOiB2b2lkIDAsXG4gIGNhbGxlclNpZ25hbDogXCJcIixcbiAgY2FsbGVyU3RyZWFtOiBudWxsLFxuICBjb25uZWN0aW9uOiBudWxsLFxuICBzZXRDYWxsZXJVaWQ6IChjYWxsZXJVaWQpID0+IHNldCgoKSA9PiAoeyBjYWxsZXJVaWQgfSkpLFxuICBzZXRDYWxsZXJTaWduYWw6IChjYWxsZXJTaWduYWwpID0+IHNldCgoKSA9PiAoeyBjYWxsZXJTaWduYWwgfSkpLFxuICBzZXRDYWxsZXJTdHJlYW06IChjYWxsZXJTdHJlYW0pID0+IHNldCgoKSA9PiAoeyBjYWxsZXJTdHJlYW0gfSkpLFxuICBzZXRDb25uZWN0aW9uOiAocGVlcikgPT4gc2V0KCgpID0+ICh7IGNvbm5lY3Rpb246IHBlZXIgfSkpXG59KTtcbnZhciBjcmVhdGVDYWxsZXJTbGljZV9kZWZhdWx0ID0gY3JlYXRlQ2FsbGVyU2xpY2U7XG5cbi8vIHNyYy9zdG9yZS9jcmVhdGVNZWRpYVNsaWNlLnRzXG52YXIgY3JlYXRlTWVkaWFTbGljZSA9IChzZXQsIGdldCkgPT4gKHtcbiAgbWVkaWFEZXZpY2U6IHZvaWQgMCxcbiAgc3RyZWFtOiB2b2lkIDAsXG4gIHN0cmVhbUVycm9yOiB2b2lkIDAsXG4gIGRldmljZUxvYWRpbmc6IHRydWUsXG4gIHN0cmVhbXNBcnJ5OiBbXSxcbiAgZW5hYmxlU3RyZWFtOiAoKSA9PiBfX2FzeW5jKHZvaWQgMCwgbnVsbCwgZnVuY3Rpb24qICgpIHtcbiAgICB2YXIgX2E7XG4gICAgaWYgKGdldCgpLnN0cmVhbSkge1xuICAgICAgY29uc29sZS5lcnJvcih7XG4gICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgbXNnOiBcImNyZWF0ZU1lZGlhU2xpY2UuZW5hYmxlU3RyZWFtKCkgfCBObyBzdHJlYW1cIlxuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGRldmljZUVuYWJsZWRDb25zdHJhaW5zID0ge1xuICAgICAgdmlkZW86IHtcbiAgICAgICAgd2lkdGg6IHsgaWRlYWw6IDEyODAgfSxcbiAgICAgICAgaGVpZ2h0OiB7IGlkZWFsOiA3MjAgfSxcbiAgICAgICAgZGV2aWNlSWQ6IChfYSA9IGdldCgpLm1lZGlhRGV2aWNlKSA9PSBudWxsID8gdm9pZCAwIDogX2EuZGV2aWNlSWRcbiAgICAgIH1cbiAgICB9O1xuICAgIHlpZWxkIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKGRldmljZUVuYWJsZWRDb25zdHJhaW5zKS50aGVuKChfc3RyZWFtKSA9PiB7XG4gICAgICBjb25zdCBfbmV3U3RyZWFtQXJyYXkgPSBbLi4uZ2V0KCkuc3RyZWFtc0FycnksIF9zdHJlYW1dO1xuICAgICAgc2V0KCgpID0+ICh7XG4gICAgICAgIHN0cmVhbTogX3N0cmVhbSxcbiAgICAgICAgZGV2aWNlTG9hZGluZzogZmFsc2UsXG4gICAgICAgIHN0cmVhbXNBcnJ5OiBfbmV3U3RyZWFtQXJyYXlcbiAgICAgIH0pKTtcbiAgICB9KS5jYXRjaCgoX2Vycm9yKSA9PiB7XG4gICAgICBzZXQoKCkgPT4gKHtcbiAgICAgICAgc3RyZWFtRXJyb3I6IHtcbiAgICAgICAgICB0eXBlOiBfZXJyb3IubmFtZSxcbiAgICAgICAgICBibG9ja2VkOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIGRldmljZUxvYWRpbmc6IGZhbHNlXG4gICAgICB9KSk7XG4gICAgfSk7XG4gICAgaWYgKCFnZXQoKS5tZWRpYURldmljZSkge1xuICAgICAgY29uc3QgbWVkaWFEZXZpY2VzID0geWllbGQgZ2V0KCkuZ2V0TWVkaWFEZXZpY2VzKCk7XG4gICAgICBjb25zb2xlLmluZm8oeyBtZWRpYURldmljZXMgfSk7XG4gICAgICBnZXQoKS5zZXRNZWRpYURldmljZShtZWRpYURldmljZXNbMF0pO1xuICAgIH1cbiAgfSksXG4gIGdldE1lZGlhRGV2aWNlczogKCkgPT4gX19hc3luYyh2b2lkIDAsIG51bGwsIGZ1bmN0aW9uKiAoKSB7XG4gICAgY29uc3QgeyBzZXRTdHJlYW1FcnJvciB9ID0gZ2V0KCk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG1lZGlhRGV2aWNlcyA9IHlpZWxkIG5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcygpO1xuICAgICAgY29uc3QgZGV2aWNlcyA9IG1lZGlhRGV2aWNlcy5maWx0ZXIoKHsga2luZCB9KSA9PiBraW5kID09PSBcInZpZGVvaW5wdXRcIik7XG4gICAgICByZXR1cm4gZGV2aWNlcztcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHNldFN0cmVhbUVycm9yKGVyciA9PSBudWxsID8gdm9pZCAwIDogZXJyLm5hbWUpO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgfSksXG4gIHNldE1lZGlhRGV2aWNlOiAoZGV2aWNlKSA9PiB7XG4gICAgc2V0KCgpID0+ICh7XG4gICAgICBtZWRpYURldmljZTogZGV2aWNlXG4gICAgfSkpO1xuICAgIGNvbnNvbGUuaW5mbyhcInNldFwiKTtcbiAgfSxcbiAgc3dpdGNoTWVkaWFTdHJlYW06IChzdHJlYW0pID0+IHtcbiAgICBjb25zb2xlLmluZm8oe1xuICAgICAgdHlwZTogXCJpbmZvXCIsXG4gICAgICBtc2c6IFwic3dpdGNoTWVkaWFTdHJlYW0oKSB8IFN3aXRjaGluZyBtZWRpYSBzdHJlYW1cIlxuICAgIH0pO1xuICAgIGlmICghc3RyZWFtKSB7XG4gICAgICBjb25zb2xlLmluZm8oe1xuICAgICAgICB0eXBlOiBcImluZm9cIixcbiAgICAgICAgbXNnOiBcInN3aXRjaE1lZGlhU3RyZWFtKCkgfCBObyBzdHJlYW0gRm91bmQgdXNpbmcgZGVmYXVsdCBTdHJlYW1cIlxuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGdldCgpLnBhdXNlVHJhY2tzKCk7XG4gICAgZ2V0KCkuc2V0TWVkaWFTdHJlYW0oc3RyZWFtKTtcbiAgfSxcbiAgc2V0TWVkaWFTdHJlYW06IChzdHJlYW0pID0+IHtcbiAgICBjb25zb2xlLmluZm8oe1xuICAgICAgdHlwZTogXCJpbmZvXCIsXG4gICAgICBtc2c6IFwic2V0TWVkaWFTdHJlYW0oKSB8IFNldHRpbmcgbWVkaWEgc3RyZWFtXCIsXG4gICAgICBzdHJlYW1cbiAgICB9KTtcbiAgICBzZXQoKCkgPT4gKHsgc3RyZWFtIH0pKTtcbiAgfSxcbiAgcGF1c2VUcmFja3M6ICgpID0+IHtcbiAgICBjb25zdCB7IHN0cmVhbSB9ID0gZ2V0KCk7XG4gICAgaWYgKCFzdHJlYW0pXG4gICAgICByZXR1cm47XG4gICAgZ2V0KCkuc3RyZWFtc0FycnkuZm9yRWFjaCgoc3RyZWFtMikgPT4ge1xuICAgICAgc3RyZWFtMi5nZXRUcmFja3MoKS5mb3JFYWNoKCh0cmFjaykgPT4ge1xuICAgICAgICB0cmFjay5zdG9wKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaCgodHJhY2spID0+IHRyYWNrLnN0b3AoKSk7XG4gICAgc2V0KCgpID0+ICh7IHN0cmVhbTogdm9pZCAwLCBzdHJlYW1zQXJyeTogW10gfSkpO1xuICB9LFxuICBzZXREZXZpY2VMb2FkaW5nOiAobG9hZGluZykgPT4ge1xuICAgIHNldCgoKSA9PiAoeyBkZXZpY2VMb2FkaW5nOiBsb2FkaW5nIH0pKTtcbiAgfSxcbiAgc2V0U3RyZWFtRXJyb3I6IChlcnJvcikgPT4ge1xuICAgIHNldCgoKSA9PiAoe1xuICAgICAgc3RyZWFtRXJyb3I6IHtcbiAgICAgICAgdHlwZTogZXJyb3IgfHwgXCJVbmtub3duRXJyb3JcIixcbiAgICAgICAgYmxvY2tlZDogZXJyb3IgPT09IFwiTm90QWxsb3dlZEVycm9yXCJcbiAgICAgIH1cbiAgICB9KSk7XG4gIH1cbn0pO1xudmFyIGNyZWF0ZU1lZGlhU2xpY2VfZGVmYXVsdCA9IGNyZWF0ZU1lZGlhU2xpY2U7XG5cbi8vIHNyYy9zdG9yZS9jcmVhdGVNaWNTbGljZS50c1xudmFyIGNyZWF0ZU1pY1NsaWNlID0gKHNldCwgZ2V0KSA9PiAoe1xuICBtaWNTdGF0ZToge1xuICAgIG1lZGlhRGV2aWNlOiB2b2lkIDAsXG4gICAgc3RyZWFtOiB2b2lkIDAsXG4gICAgc3RyZWFtRXJyb3I6IG51bGwsXG4gICAgZGV2aWNlTG9hZGluZzogdHJ1ZVxuICB9LFxuICBlbmFibGVBdWRpb1N0cmVhbTogKCkgPT4gX19hc3luYyh2b2lkIDAsIG51bGwsIGZ1bmN0aW9uKiAoKSB7XG4gICAgdmFyIF9hO1xuICAgIGlmIChnZXQoKS5taWNTdGF0ZS5zdHJlYW0pIHtcbiAgICAgIGNvbnNvbGUuZXJyb3Ioe1xuICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgIG1zZzogXCJjcmVhdGVNZWRpYVNsaWNlLmVuYWJsZVN0cmVhbSgpIHwgTm8gc3RyZWFtXCJcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBkZXZpY2VFbmFibGVkQ29uc3RyYWlucyA9IHtcbiAgICAgIGF1ZGlvOiB7XG4gICAgICAgIGRldmljZUlkOiAoX2EgPSBnZXQoKS5taWNTdGF0ZS5tZWRpYURldmljZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmRldmljZUlkXG4gICAgICB9XG4gICAgfTtcbiAgICBjb25zb2xlLmluZm8oXCJFbmFibGluZyBuZXcgTWljIHN0cmVhbVwiKTtcbiAgICB5aWVsZCBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYShkZXZpY2VFbmFibGVkQ29uc3RyYWlucykudGhlbigoX3N0cmVhbSkgPT4ge1xuICAgICAgc2V0KCgpID0+ICh7XG4gICAgICAgIG1pY1N0YXRlOiBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBnZXQoKS5taWNTdGF0ZSksIHtcbiAgICAgICAgICBzdHJlYW06IF9zdHJlYW0sXG4gICAgICAgICAgZGV2aWNlTG9hZGluZzogZmFsc2VcbiAgICAgICAgfSlcbiAgICAgIH0pKTtcbiAgICB9KS5jYXRjaCgoX2Vycm9yKSA9PiB7XG4gICAgICBzZXQoKCkgPT4gKHtcbiAgICAgICAgbWljU3RhdGU6IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIGdldCgpLm1pY1N0YXRlKSwge1xuICAgICAgICAgIHN0cmVhbUVycm9yOiB7XG4gICAgICAgICAgICB0eXBlOiBfZXJyb3IubmFtZSxcbiAgICAgICAgICAgIGJsb2NrZWQ6IF9lcnJvci5uYW1lID09PSBcIk5vdEFsbG93ZWRFcnJvclwiXG4gICAgICAgICAgfSxcbiAgICAgICAgICBkZXZpY2VMb2FkaW5nOiBmYWxzZVxuICAgICAgICB9KVxuICAgICAgfSkpO1xuICAgIH0pO1xuICAgIGlmICghZ2V0KCkubWljU3RhdGUubWVkaWFEZXZpY2UpIHtcbiAgICAgIGNvbnN0IGF1ZGlvRGV2aWNlcyA9IHlpZWxkIGdldCgpLmdldEF1ZGlvRGV2aWNlcygpO1xuICAgICAgY29uc29sZS5pbmZvKHsgYXVkaW9EZXZpY2VzIH0pO1xuICAgICAgZ2V0KCkuc2V0QXVkaW9EZXZpY2UoYXVkaW9EZXZpY2VzWzBdKTtcbiAgICB9XG4gIH0pLFxuICBnZXRBdWRpb0RldmljZXM6ICgpID0+IF9fYXN5bmModm9pZCAwLCBudWxsLCBmdW5jdGlvbiogKCkge1xuICAgIGNvbnN0IHsgc2V0QXVkaW9TdHJlYW1FcnJvciB9ID0gZ2V0KCk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG1lZGlhRGV2aWNlcyA9IHlpZWxkIG5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcygpO1xuICAgICAgY29uc3QgZGV2aWNlcyA9IG1lZGlhRGV2aWNlcy5maWx0ZXIoKHsga2luZCB9KSA9PiBraW5kID09PSBcImF1ZGlvaW5wdXRcIik7XG4gICAgICByZXR1cm4gZGV2aWNlcztcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHNldEF1ZGlvU3RyZWFtRXJyb3IoZXJyID09IG51bGwgPyB2b2lkIDAgOiBlcnIubmFtZSk7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9KSxcbiAgc2V0QXVkaW9EZXZpY2U6IChkZXZpY2UpID0+IHtcbiAgICBzZXQoKCkgPT4gKHtcbiAgICAgIG1pY1N0YXRlOiBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBnZXQoKS5taWNTdGF0ZSksIHtcbiAgICAgICAgbWVkaWFEZXZpY2U6IGRldmljZVxuICAgICAgfSlcbiAgICB9KSk7XG4gIH0sXG4gIHN3aXRjaEF1ZGlvU3RyZWFtOiAoc3RyZWFtKSA9PiB7XG4gICAgY29uc29sZS5pbmZvKHtcbiAgICAgIHR5cGU6IFwiaW5mb1wiLFxuICAgICAgbXNnOiBcInN3aXRjaEF1ZGlvU3RyZWFtKCkgfCBTd2l0Y2hpbmcgQSBzdHJlYW1cIlxuICAgIH0pO1xuICAgIGlmICghc3RyZWFtKSB7XG4gICAgICBjb25zb2xlLmluZm8oe1xuICAgICAgICB0eXBlOiBcImluZm9cIixcbiAgICAgICAgbXNnOiBcInN3aXRjaEF1ZGlvU3RyZWFtKCkgfCBObyBzdHJlYW0gRm91bmQgdXNpbmcgZGVmYXVsdCBTdHJlYW1cIlxuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGdldCgpLnBhdXNlQXVkaW9UcmFja3MoKTtcbiAgICBnZXQoKS5zZXRBdWRpb1N0cmVhbShzdHJlYW0pO1xuICB9LFxuICBzZXRBdWRpb1N0cmVhbTogKHN0cmVhbSkgPT4ge1xuICAgIGNvbnNvbGUuaW5mbyh7XG4gICAgICB0eXBlOiBcImluZm9cIixcbiAgICAgIG1zZzogXCJzZXRBdWRpb1N0cmVhbSgpIHwgU2V0dGluZyBBdWRpbyBzdHJlYW1cIixcbiAgICAgIHN0cmVhbVxuICAgIH0pO1xuICAgIHNldCgoKSA9PiAoe1xuICAgICAgbWljU3RhdGU6IF9fc3ByZWFkUHJvcHMoX19zcHJlYWRWYWx1ZXMoe30sIGdldCgpLm1pY1N0YXRlKSwge1xuICAgICAgICBzdHJlYW1cbiAgICAgIH0pXG4gICAgfSkpO1xuICB9LFxuICBwYXVzZUF1ZGlvVHJhY2tzOiAoKSA9PiB7XG4gICAgY29uc3QgeyBzdHJlYW0gfSA9IGdldCgpLm1pY1N0YXRlO1xuICAgIGlmICghc3RyZWFtKVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnNvbGUuaW5mbyh7XG4gICAgICB0eXBlOiBcImluZm9cIixcbiAgICAgIG1zZzogXCJwYXVzZUF1ZGlvVHJhY2tzKCkgfCBQYXVzaW5nIEF1ZGlvIHN0cmVhbVwiXG4gICAgfSk7XG4gICAgc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2goKHRyYWNrKSA9PiB0cmFjay5zdG9wKCkpO1xuICAgIHNldCgoKSA9PiAoeyBtaWNTdGF0ZTogX19zcHJlYWRQcm9wcyhfX3NwcmVhZFZhbHVlcyh7fSwgZ2V0KCkubWljU3RhdGUpLCB7IHN0cmVhbTogdm9pZCAwIH0pIH0pKTtcbiAgfSxcbiAgc2V0QXVkaW9EZXZpY2VMb2FkaW5nOiAobG9hZGluZykgPT4ge1xuICAgIHNldCgoKSA9PiAoeyBtaWNTdGF0ZTogX19zcHJlYWRQcm9wcyhfX3NwcmVhZFZhbHVlcyh7fSwgZ2V0KCkubWljU3RhdGUpLCB7IGRldmljZUxvYWRpbmc6IGxvYWRpbmcgfSkgfSkpO1xuICB9LFxuICBzZXRBdWRpb1N0cmVhbUVycm9yOiAoZXJyb3IpID0+IHtcbiAgICBzZXQoKCkgPT4gKHtcbiAgICAgIG1pY1N0YXRlOiBfX3NwcmVhZFByb3BzKF9fc3ByZWFkVmFsdWVzKHt9LCBnZXQoKS5taWNTdGF0ZSksIHtcbiAgICAgICAgc3RyZWFtRXJyb3I6IHtcbiAgICAgICAgICB0eXBlOiBlcnJvciB8fCBcIlVua25vd25FcnJvclwiLFxuICAgICAgICAgIGJsb2NrZWQ6IGVycm9yID09PSBcIk5vdEFsbG93ZWRFcnJvclwiXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfSkpO1xuICB9XG59KTtcbnZhciBjcmVhdGVNaWNTbGljZV9kZWZhdWx0ID0gY3JlYXRlTWljU2xpY2U7XG5cbi8vIHNyYy9zdG9yZS9jcmVhdGVVc2VyU2xpY2UudHNcbnZhciBjcmVhdGVVc2VyU2xpY2UgPSAoc2V0LCBnZXQpID0+ICh7XG4gIHVzZXI6IHtcbiAgICB1aWQ6IFwiXCIsXG4gICAgc29ja2V0OiBcIlwiLFxuICAgIG5vZGU6IFwiXCIsXG4gICAgYXZhdGFyVXJsOiBcIlwiLFxuICAgIG1lc3NhZ2VzOiBbXVxuICB9LFxuICBjb25uZWN0aW9uOiBudWxsLFxuICBwZWVyOiBudWxsLFxuICBjb252ZXJzYXRpb25zOiB7fSxcbiAgZ3JvdXBzOiB7fSxcbiAgc3luY01lc3NhZ2VzOiBbXSxcbiAgaW5jb3JyZWN0S2V5czogZmFsc2UsXG4gIHNldFVzZXI6ICh1c2VyKSA9PiBzZXQoKCkgPT4gKHsgdXNlciB9KSksXG4gIHNldFBlZXI6IChwZWVyKSA9PiBzZXQoKCkgPT4gKHsgcGVlciB9KSksXG4gIHNldENvbm5lY3Rpb246IChwZWVyKSA9PiBzZXQoKCkgPT4gKHsgY29ubmVjdGlvbjogcGVlciB9KSlcbn0pO1xudmFyIGNyZWF0ZVVzZXJTbGljZV9kZWZhdWx0ID0gY3JlYXRlVXNlclNsaWNlO1xuXG4vLyBzcmMvc3RvcmUvY3JlYXRlRXJyb3JTbGljZS50c1xudmFyIGNyZWF0ZUVycm9yU2xpY2UgPSAoc2V0KSA9PiAoe1xuICBlcnJvclR5cGU6IG51bGwsXG4gIGVycm9yTWVzc2FnZTogdm9pZCAwLFxuICBzZXRFcnJvcjogKHR5cGUsIG1zZykgPT4gc2V0KCgpID0+ICh7IGVycm9yVHlwZTogdHlwZSwgZXJyb3JNZXNzYWdlOiBtc2cgfSkpLFxuICByZXNldEVycm9yOiAoKSA9PiBzZXQoKCkgPT4gKHsgZXJyb3JUeXBlOiBudWxsLCBlcnJvck1lc3NhZ2U6IHZvaWQgMCB9KSlcbn0pO1xudmFyIGNyZWF0ZUVycm9yU2xpY2VfZGVmYXVsdCA9IGNyZWF0ZUVycm9yU2xpY2U7XG5cbi8vIHNyYy9zdG9yZS91c2VSb290U3RvcmUudHNcbnZhciBjcmVhdGVSb290U2xpY2UgPSAoc2V0LCBnZXQpID0+IF9fc3ByZWFkVmFsdWVzKF9fc3ByZWFkVmFsdWVzKF9fc3ByZWFkVmFsdWVzKF9fc3ByZWFkVmFsdWVzKF9fc3ByZWFkVmFsdWVzKHt9LCBjcmVhdGVDYWxsZXJTbGljZV9kZWZhdWx0KHNldCwgZ2V0KSksIGNyZWF0ZU1lZGlhU2xpY2VfZGVmYXVsdChzZXQsIGdldCkpLCBjcmVhdGVNaWNTbGljZV9kZWZhdWx0KHNldCwgZ2V0KSksIGNyZWF0ZVVzZXJTbGljZV9kZWZhdWx0KHNldCwgZ2V0KSksIGNyZWF0ZUVycm9yU2xpY2VfZGVmYXVsdChzZXQsIGdldCkpO1xudmFyIHVzZURpdmVyZ2VudFN0b3JlID0gY3JlYXRlKFxuICBkZXZ0b29scyhjcmVhdGVSb290U2xpY2UsIHtcbiAgICBuYW1lOiBcImRpdmVyZ2VudC1jbGllbnRcIixcbiAgICBhbm9ueW1vdXNBY3Rpb25UeXBlOiBcImFjdGlvblwiXG4gIH0pXG4pO1xudmFyIHsgZ2V0U3RhdGUsIHNldFN0YXRlIH0gPSB1c2VEaXZlcmdlbnRTdG9yZTtcbnZhciB1c2VSb290U3RvcmVfZGVmYXVsdCA9IHVzZURpdmVyZ2VudFN0b3JlO1xuXG4vLyBzcmMvRGl2ZXJnZW50QVZDbGllbnQvaW5kZXgudHN4XG5pbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5cbi8vIHNyYy9EaXZlcmdlbnRBVkNsaWVudC9jb250ZXh0LnRzXG5pbXBvcnQgeyBjcmVhdGVDb250ZXh0IH0gZnJvbSBcInJlYWN0XCI7XG52YXIgRGl2ZXJnZW50QVZDbGllbnRDb250ZXh0ID0gY3JlYXRlQ29udGV4dChcbiAge31cbik7XG5cbi8vIHNyYy9EaXZlcmdlbnRBVkNsaWVudC9EaXZlcmdlbnRBVkNsaWVudC50c1xuaW1wb3J0IHsgaW8gfSBmcm9tIFwic29ja2V0LmlvLWNsaWVudFwiO1xuaW1wb3J0IFBlZXIgZnJvbSBcInNpbXBsZS1wZWVyXCI7XG5cbi8vIHNyYy9EaXZlcmdlbnRBVkNsaWVudC91dGlscy9sb2dnZXIudHNcbmltcG9ydCBwaW5vIGZyb20gXCJwaW5vXCI7XG52YXIgbG9nZ2VyID0gcGlubyh7XG4gIGJyb3dzZXI6IHsgYXNPYmplY3Q6IGZhbHNlIH0sXG4gIGVuYWJsZWQ6IHRydWVcbn0pO1xudmFyIGxvZ2dlcl9kZWZhdWx0ID0gbG9nZ2VyO1xuXG4vLyBzcmMvRGl2ZXJnZW50QVZDbGllbnQvdXRpbHMvVmVybmVyL3Zlcm5lci50c1xuaW1wb3J0IG5hY2wgZnJvbSBcInR3ZWV0bmFjbFwiO1xuXG4vLyBzcmMvRGl2ZXJnZW50QVZDbGllbnQvdXRpbHMvVmVybmVyL3Zlcm5lci11dGlscy50c1xuaW1wb3J0IGVkMmN1cnZlIGZyb20gXCJlZDJjdXJ2ZVwiO1xuaW1wb3J0IHV0aWwgZnJvbSBcInR3ZWV0bmFjbC11dGlsXCI7XG52YXIgdmVybmVyVXRpbHMgPSB7XG4gIGNvbnZlcnRQdWJsaWNLZXk6IChwdWJsaWNLZXkpID0+IHtcbiAgICBjb25zdCBwayA9IGVkMmN1cnZlLmNvbnZlcnRQdWJsaWNLZXkocHVibGljS2V5KTtcbiAgICBpZiAocGspXG4gICAgICByZXR1cm4gcGs7XG4gICAgZWxzZVxuICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KCk7XG4gIH0sXG4gIGNvbnZlcnRTZWNyZXRLZXk6IChzZWNyZXRLZXkpID0+IHtcbiAgICByZXR1cm4gZWQyY3VydmUuY29udmVydFNlY3JldEtleShzZWNyZXRLZXkpO1xuICB9LFxuICBoZXhUb1VpbnQ4OiAoc3RyaW5nKSA9PiB7XG4gICAgcmV0dXJuIFVpbnQ4QXJyYXkuZnJvbShCdWZmZXIuZnJvbShzdHJpbmcsIFwiaGV4XCIpKTtcbiAgfSxcbiAgdWludDhUb0hleDogKHVpbnQ4YXJyYXkpID0+IHtcbiAgICByZXR1cm4gQnVmZmVyLmZyb20odWludDhhcnJheSkudG9TdHJpbmcoXCJoZXhcIik7XG4gIH0sXG4gIHN0clRvVXRmODogKHN0cikgPT4ge1xuICAgIGNvbnNvbGUubG9nKHN0cik7XG4gICAgcmV0dXJuIHV0aWwuZGVjb2RlVVRGOChzdHIpO1xuICB9LFxuICB1dGY4VG9TdHI6ICh1aW50OCkgPT4ge1xuICAgIHJldHVybiB1dGlsLmVuY29kZVVURjgodWludDgpO1xuICB9LFxuICB1aW50OHRvQmFzZTY0OiAodWludDgpID0+IHtcbiAgICByZXR1cm4gdXRpbC5lbmNvZGVCYXNlNjQodWludDgpO1xuICB9LFxuICBiYXNlNjRUb1VpbnQ4OiAoc3RyKSA9PiB7XG4gICAgcmV0dXJuIHV0aWwuZGVjb2RlQmFzZTY0KHN0cik7XG4gIH1cbn07XG52YXIgdmVybmVyX3V0aWxzX2RlZmF1bHQgPSB2ZXJuZXJVdGlscztcblxuLy8gc3JjL0RpdmVyZ2VudEFWQ2xpZW50L3V0aWxzL1Zlcm5lci92ZXJuZXIudHNcbnZhciBWZXJuZXIgPSB7XG4gIGdlbmVyYXRlS2V5czogKHVpZCkgPT4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBrcyA9IG5hY2wuc2lnbi5rZXlQYWlyKCk7XG4gICAgICAgIGNvbnN0IHB1YmxpY0tleSA9IHZlcm5lcl91dGlsc19kZWZhdWx0LnVpbnQ4VG9IZXgoa3MucHVibGljS2V5KTtcbiAgICAgICAgY29uc3Qgc2VjcmV0S2V5ID0gdmVybmVyX3V0aWxzX2RlZmF1bHQudWludDhUb0hleChrcy5zZWNyZXRLZXkpO1xuICAgICAgICByZXNvbHZlKHsgcHVibGljS2V5LCBzZWNyZXRLZXkgfSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJlamVjdChlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSxcbiAgZ2V0U2lnbmluZ0tleXM6IChwdWJsaWNLZXksIHNlY3JldEtleSkgPT4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBrZXlwYWlyID0gbmFjbC5zaWduLmtleVBhaXIoKTtcbiAgICAgICAgY29uc3QgcGsgPSB2ZXJuZXJfdXRpbHNfZGVmYXVsdC5oZXhUb1VpbnQ4KHB1YmxpY0tleSk7XG4gICAgICAgIGNvbnN0IHNrID0gdmVybmVyX3V0aWxzX2RlZmF1bHQuaGV4VG9VaW50OChzZWNyZXRLZXkpO1xuICAgICAgICBrZXlwYWlyLnB1YmxpY0tleSA9IHBrO1xuICAgICAgICBrZXlwYWlyLnNlY3JldEtleSA9IHNrO1xuICAgICAgICByZXNvbHZlKGtleXBhaXIpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZWplY3QoZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0sXG4gIGVuY3J5cHRNZXNzYWdlOiAobWVzc2FnZSwgbm9uY2UsIHBhcnRpY2lwYW50UHVibGljS2V5LCBzZWxmU2VjcmV0S2V5KSA9PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHV0ZjhNZXNzYWdlID0gdmVybmVyX3V0aWxzX2RlZmF1bHQuc3RyVG9VdGY4KG1lc3NhZ2UpO1xuICAgICAgICBjb25zdCB1aW50OE5vbmNlID0gdmVybmVyX3V0aWxzX2RlZmF1bHQuaGV4VG9VaW50OChub25jZSk7XG4gICAgICAgIGNvbnN0IHVpbnQ4cHBrID0gdmVybmVyX3V0aWxzX2RlZmF1bHQuaGV4VG9VaW50OChwYXJ0aWNpcGFudFB1YmxpY0tleSk7XG4gICAgICAgIGNvbnN0IHVpbnQ4c3BrID0gdmVybmVyX3V0aWxzX2RlZmF1bHQuaGV4VG9VaW50OChzZWxmU2VjcmV0S2V5KTtcbiAgICAgICAgY29uc3QgY3VydmUyNTUxOXB1YmxpY0tleSA9IHZlcm5lcl91dGlsc19kZWZhdWx0LmNvbnZlcnRQdWJsaWNLZXkodWludDhwcGspO1xuICAgICAgICBjb25zdCBjdXJ2ZXIyNTUxOXNlY3JldEtleSA9IHZlcm5lcl91dGlsc19kZWZhdWx0LmNvbnZlcnRTZWNyZXRLZXkodWludDhzcGspO1xuICAgICAgICBjb25zdCBlbmNyeXB0ZWRNZXNzYWdlID0gbmFjbC5ib3goXG4gICAgICAgICAgdXRmOE1lc3NhZ2UsXG4gICAgICAgICAgdWludDhOb25jZSxcbiAgICAgICAgICBjdXJ2ZTI1NTE5cHVibGljS2V5LFxuICAgICAgICAgIGN1cnZlcjI1NTE5c2VjcmV0S2V5XG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IGVuY3J5cHRlZE1zZ1N0ciA9IHZlcm5lcl91dGlsc19kZWZhdWx0LnVpbnQ4dG9CYXNlNjQoZW5jcnlwdGVkTWVzc2FnZSk7XG4gICAgICAgIHJlc29sdmUoZW5jcnlwdGVkTXNnU3RyKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgfVxuICAgIH0pO1xuICB9LFxuICBkZWNyeXB0TWVzc2FnZTogKGVuY3J5cHRlZE1lc3NhZ2UsIG5vbmNlLCBwYXJ0aWNpcGFudFB1YmxpY0tleSwgc2VsZlNlY3JldEtleSkgPT4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB1dGY4RW5jcnlwdGVkTWVzc2FnZSA9IHZlcm5lcl91dGlsc19kZWZhdWx0LmJhc2U2NFRvVWludDgoZW5jcnlwdGVkTWVzc2FnZSk7XG4gICAgICAgIGNvbnN0IHVpbnQ4Tm9uY2UgPSB2ZXJuZXJfdXRpbHNfZGVmYXVsdC5oZXhUb1VpbnQ4KG5vbmNlKTtcbiAgICAgICAgY29uc3QgdWludDhwcGsgPSB2ZXJuZXJfdXRpbHNfZGVmYXVsdC5oZXhUb1VpbnQ4KHBhcnRpY2lwYW50UHVibGljS2V5KTtcbiAgICAgICAgY29uc3QgdWludDhzcGsgPSB2ZXJuZXJfdXRpbHNfZGVmYXVsdC5oZXhUb1VpbnQ4KHNlbGZTZWNyZXRLZXkpO1xuICAgICAgICBjb25zdCBjdXJ2ZTI1NTE5cHVibGljS2V5ID0gdmVybmVyX3V0aWxzX2RlZmF1bHQuY29udmVydFB1YmxpY0tleSh1aW50OHBwayk7XG4gICAgICAgIGNvbnN0IGN1cnZlcjI1NTE5c2VjcmV0S2V5ID0gdmVybmVyX3V0aWxzX2RlZmF1bHQuY29udmVydFNlY3JldEtleSh1aW50OHNwayk7XG4gICAgICAgIGNvbnN0IGRlY3J5cHRlZE1lc3NhZ2UgPSBuYWNsLmJveC5vcGVuKFxuICAgICAgICAgIHV0ZjhFbmNyeXB0ZWRNZXNzYWdlLFxuICAgICAgICAgIHVpbnQ4Tm9uY2UsXG4gICAgICAgICAgY3VydmUyNTUxOXB1YmxpY0tleSxcbiAgICAgICAgICBjdXJ2ZXIyNTUxOXNlY3JldEtleVxuICAgICAgICApO1xuICAgICAgICBjb25zdCBkZWNyeXB0ZWRNc2dTdHIgPSB2ZXJuZXJfdXRpbHNfZGVmYXVsdC51dGY4VG9TdHIoXG4gICAgICAgICAgZGVjcnlwdGVkTWVzc2FnZVxuICAgICAgICApO1xuICAgICAgICByZXNvbHZlKGRlY3J5cHRlZE1zZ1N0cik7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJlamVjdChlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSxcbiAgZ2VuZXJhdGVOb25jZTogKCkgPT4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBub25jZUhleFN0ciA9IFsuLi5BcnJheSg0OCldLm1hcCgoKSA9PiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxNikudG9TdHJpbmcoMTYpKS5qb2luKFwiXCIpO1xuICAgICAgICByZXNvbHZlKG5vbmNlSGV4U3RyKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59O1xudmFyIHZlcm5lcl9kZWZhdWx0ID0gVmVybmVyO1xuXG4vLyBzcmMvRGl2ZXJnZW50QVZDbGllbnQvRGl2ZXJnZW50QVZDbGllbnQudHNcbmltcG9ydCBheGlvczIgZnJvbSBcImF4aW9zXCI7XG5pbXBvcnQgeyBldGhlcnMgfSBmcm9tIFwiZXRoZXJzXCI7XG5cbi8vIHNyYy9EaXZlcmdlbnRBVkNsaWVudC91dGlscy9hdXRoL2F1dGgudHNcbmltcG9ydCBheGlvcyBmcm9tIFwiYXhpb3NcIjtcbnZhciB3YWxsZXRBdXRoID0ge1xuICBfZ2VuZXJhdGVTaWduYXR1cmVNZXNzYWdlOiAod2FsbGV0QWRkcmVzcykgPT4gX19hc3luYyh2b2lkIDAsIG51bGwsIGZ1bmN0aW9uKiAoKSB7XG4gICAgY29uc3QgaWRlbnRpdHlQcm92aWRlclJlc3BvbnNlID0geWllbGQgYXhpb3MuZ2V0KFxuICAgICAgYGh0dHBzOi8vYXBpLmlkZW50aXR5LnRlc3RpbmcuaHVkZGxlMDEuY29tL3NpZ24tbWVzc2FnZT9hZGRyZXNzPSR7d2FsbGV0QWRkcmVzc31gXG4gICAgKTtcbiAgICByZXR1cm4gaWRlbnRpdHlQcm92aWRlclJlc3BvbnNlLmRhdGEubWVzc2FnZTtcbiAgfSksXG4gIHZlcmlmeVNpZ25hdHVyZTogKHdhbGxldEFkZHJlc3MsIHNpZ25NZXNzYWdlLCBzaWduYXR1cmUpID0+IF9fYXN5bmModm9pZCAwLCBudWxsLCBmdW5jdGlvbiogKCkge1xuICAgIGNvbnN0IGFwaVJlc3BvbnNlID0geWllbGQgYXhpb3MucG9zdChcbiAgICAgIFwiaHR0cHM6Ly9hcGkuaWRlbnRpdHkudGVzdGluZy5odWRkbGUwMS5jb20vbG9naW5cIixcbiAgICAgIHtcbiAgICAgICAgYWRkcmVzczogd2FsbGV0QWRkcmVzcyxcbiAgICAgICAgc2lnbmF0dXJlLFxuICAgICAgICBtZXNzYWdlOiBzaWduTWVzc2FnZSxcbiAgICAgICAgd2FsbGV0VHlwZTogXCJldGhlcmV1bVwiLFxuICAgICAgICBwbGF0Zm9ybU9yaWdpbjogXCJ3ZWItcGxhdGZvcm1cIlxuICAgICAgfVxuICAgICk7XG4gICAgcmV0dXJuIGFwaVJlc3BvbnNlLmRhdGE7XG4gIH0pXG59O1xudmFyIGxlbnNBdXRoID0ge1xuICBnZXRTaWduYXR1cmVNZXNzYWdlOiAoYWRkcmVzcykgPT4gX19hc3luYyh2b2lkIDAsIG51bGwsIGZ1bmN0aW9uKiAoKSB7XG4gICAgY29uc3QgYXBpUmVzcG9uc2UgPSB5aWVsZCBheGlvcy5wb3N0KFwiaHR0cHM6Ly9hcGkubGVucy5kZXZcIiwge1xuICAgICAgcXVlcnk6IGBxdWVyeSBDaGFsbGVuZ2UoJGFkZHJlc3M6IEV0aGVyZXVtQWRkcmVzcyEpIHtcbiAgICAgICAgICAgICAgY2hhbGxlbmdlKHJlcXVlc3Q6IHsgYWRkcmVzczogJGFkZHJlc3MgfSkge1xuICAgICAgICAgICAgICB0ZXh0XG4gICAgICAgICAgICB9XG4gICAgICAgIH1gLFxuICAgICAgdmFyaWFibGVzOiB7XG4gICAgICAgIGFkZHJlc3NcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gYXBpUmVzcG9uc2UuZGF0YS5kYXRhLmNoYWxsZW5nZS50ZXh0O1xuICB9KSxcbiAgZ2V0VG9rZW5zOiAoYWRkcmVzcywgc2lnbmF0dXJlKSA9PiBfX2FzeW5jKHZvaWQgMCwgbnVsbCwgZnVuY3Rpb24qICgpIHtcbiAgICBjb25zdCBhcGlSZXNwb25zZSA9IHlpZWxkIGF4aW9zLnBvc3QoXG4gICAgICBcImh0dHBzOi8vYXBpLmlkZW50aXR5LnRlc3RpbmcuaHVkZGxlMDEuY29tL2xvZ2luLWRpZFwiLFxuICAgICAge1xuICAgICAgICBkaWRBY2Nlc3NUb2tlbjogc2lnbmF0dXJlLFxuICAgICAgICBhZGRyZXNzLFxuICAgICAgICB3YWxsZXRUeXBlOiBcImxlbnNcIixcbiAgICAgICAgcGxhdGZvcm1PcmlnaW46IFwid2ViLXBsYXRmb3JtXCJcbiAgICAgIH1cbiAgICApO1xuICAgIHJldHVybiBhcGlSZXNwb25zZS5kYXRhO1xuICB9KSxcbiAgZ2V0SGFuZGxlOiAoYWRkcmVzcykgPT4gX19hc3luYyh2b2lkIDAsIG51bGwsIGZ1bmN0aW9uKiAoKSB7XG4gICAgY29uc3QgYXBpUmVzcG9uc2UgPSB5aWVsZCBheGlvcy5wb3N0KFwiaHR0cHM6Ly9hcGkubGVucy5kZXZcIiwge1xuICAgICAgcXVlcnk6IGBxdWVyeSBQcm9maWxlcygkYWRkcmVzczogRXRoZXJldW1BZGRyZXNzISkge1xuICAgICAgIHByb2ZpbGVzKHJlcXVlc3Q6IHsgb3duZWRCeTogWyRhZGRyZXNzXSwgbGltaXQ6IDEwIH0pIHtcbiAgICAgICAgIGl0ZW1zIHtcbiAgICAgICAgICAgaWRcbiAgICAgICAgICAgbmFtZVxuICAgICAgICAgICBoYW5kbGVcbiAgICAgICAgIH1cbiAgICAgICB9XG4gICAgIH1gLFxuICAgICAgdmFyaWFibGVzOiB7XG4gICAgICAgIGFkZHJlc3NcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gYXBpUmVzcG9uc2UuZGF0YS5kYXRhLnByb2ZpbGVzLml0ZW1zWzBdLmhhbmRsZTtcbiAgfSlcbn07XG5cbi8vIHNyYy9EaXZlcmdlbnRBVkNsaWVudC91dGlscy9LTVNVdGlscy50c1xudmFyIEtNU1V0aWxzID0ge1xuICBnZW5lcmF0ZUlkZW50aXR5S2V5OiAoKSA9PiBfX2FzeW5jKHZvaWQgMCwgbnVsbCwgZnVuY3Rpb24qICgpIHtcbiAgICBsZXQga2V5ID0geWllbGQgd2luZG93LmNyeXB0by5zdWJ0bGUuZ2VuZXJhdGVLZXkoXG4gICAgICB7XG4gICAgICAgIG5hbWU6IFwiQUVTLUdDTVwiLFxuICAgICAgICBsZW5ndGg6IDI1NlxuICAgICAgfSxcbiAgICAgIHRydWUsXG4gICAgICBbXCJlbmNyeXB0XCIsIFwiZGVjcnlwdFwiXVxuICAgICk7XG4gICAgY29uc3QgcmF3S2V5QnVmID0geWllbGQgd2luZG93LmNyeXB0by5zdWJ0bGUuZXhwb3J0S2V5KFwicmF3XCIsIGtleSk7XG4gICAgY29uc3QgcmF3S2V5QXJyID0gbmV3IFVpbnQ4QXJyYXkocmF3S2V5QnVmKTtcbiAgICByZXR1cm4gQnVmZmVyLmZyb20ocmF3S2V5QXJyKS50b1N0cmluZyhcImhleFwiKTtcbiAgfSksXG4gIGFlc0djbUVuY3J5cHQ6IChzZWNyZXRLZXksIHNpZ25hdHVyZSkgPT4gX19hc3luYyh2b2lkIDAsIG51bGwsIGZ1bmN0aW9uKiAoKSB7XG4gICAgY29uc3QgcHdVdGY4ID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHNpZ25hdHVyZSk7XG4gICAgY29uc3QgcHdIYXNoID0geWllbGQgd2luZG93LmNyeXB0by5zdWJ0bGUuZGlnZXN0KFwiU0hBLTI1NlwiLCBwd1V0ZjgpO1xuICAgIGNvbnN0IGl2ID0geWllbGQgd2luZG93LmNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoMTIpKTtcbiAgICBjb25zdCBpdlN0ciA9IEFycmF5LmZyb20oaXYpLm1hcCgoYikgPT4gU3RyaW5nLmZyb21DaGFyQ29kZShiKSkuam9pbihcIlwiKTtcbiAgICBjb25zdCBhbGcgPSB7IG5hbWU6IFwiQUVTLUdDTVwiLCBpdiB9O1xuICAgIGNvbnN0IGtleSA9IHlpZWxkIHdpbmRvdy5jcnlwdG8uc3VidGxlLmltcG9ydEtleShcbiAgICAgIFwicmF3XCIsXG4gICAgICBwd0hhc2gsXG4gICAgICBhbGcsXG4gICAgICBmYWxzZSxcbiAgICAgIFtcImVuY3J5cHRcIl1cbiAgICApO1xuICAgIGNvbnN0IHB0VWludDggPSBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoc2VjcmV0S2V5KTtcbiAgICBjb25zdCBjdEJ1ZmZlciA9IHlpZWxkIHdpbmRvdy5jcnlwdG8uc3VidGxlLmVuY3J5cHQoYWxnLCBrZXksIHB0VWludDgpO1xuICAgIGNvbnN0IGN0QXJyYXkgPSBBcnJheS5mcm9tKG5ldyBVaW50OEFycmF5KGN0QnVmZmVyKSk7XG4gICAgY29uc3QgY3RTdHIgPSBjdEFycmF5Lm1hcCgoYnl0ZSkgPT4gU3RyaW5nLmZyb21DaGFyQ29kZShieXRlKSkuam9pbihcIlwiKTtcbiAgICByZXR1cm4gYnRvYShpdlN0ciArIGN0U3RyKTtcbiAgfSksXG4gIGFlc0djbURlY3J5cHQ6IChjaXBoZXJLZXksIHNpZ25hdHVyZSkgPT4gX19hc3luYyh2b2lkIDAsIG51bGwsIGZ1bmN0aW9uKiAoKSB7XG4gICAgY29uc3QgcHdVdGY4ID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHNpZ25hdHVyZSk7XG4gICAgY29uc3QgcHdIYXNoID0geWllbGQgd2luZG93LmNyeXB0by5zdWJ0bGUuZGlnZXN0KFwiU0hBLTI1NlwiLCBwd1V0ZjgpO1xuICAgIGNvbnN0IGl2U3RyID0gYXRvYihjaXBoZXJLZXkpLnNsaWNlKDAsIDEyKTtcbiAgICBjb25zdCBpdiA9IG5ldyBVaW50OEFycmF5KEFycmF5LmZyb20oaXZTdHIpLm1hcCgoY2gpID0+IGNoLmNoYXJDb2RlQXQoMCkpKTtcbiAgICBjb25zdCBhbGcgPSB7IG5hbWU6IFwiQUVTLUdDTVwiLCBpdiB9O1xuICAgIGNvbnN0IGtleSA9IHlpZWxkIHdpbmRvdy5jcnlwdG8uc3VidGxlLmltcG9ydEtleShcbiAgICAgIFwicmF3XCIsXG4gICAgICBwd0hhc2gsXG4gICAgICBhbGcsXG4gICAgICBmYWxzZSxcbiAgICAgIFtcImRlY3J5cHRcIl1cbiAgICApO1xuICAgIGNvbnN0IGN0U3RyID0gYXRvYihjaXBoZXJLZXkpLnNsaWNlKDEyKTtcbiAgICBjb25zdCBjdFVpbnQ4ID0gbmV3IFVpbnQ4QXJyYXkoXG4gICAgICBBcnJheS5mcm9tKGN0U3RyKS5tYXAoKGNoKSA9PiBjaC5jaGFyQ29kZUF0KDApKVxuICAgICk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBsYWluQnVmZmVyID0geWllbGQgd2luZG93LmNyeXB0by5zdWJ0bGUuZGVjcnlwdChhbGcsIGtleSwgY3RVaW50OCk7XG4gICAgICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKHBsYWluQnVmZmVyKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZGVjcnlwdCBmYWlsZWRcIik7XG4gICAgfVxuICB9KVxufTtcbnZhciBLTVNVdGlsc19kZWZhdWx0ID0gS01TVXRpbHM7XG5cbi8vIHNyYy9EaXZlcmdlbnRBVkNsaWVudC9EaXZlcmdlbnRBVkNsaWVudC50c1xudmFyIGdldERpdmVyZ2VudFN0b3JlO1xudmFyIERpdmVyZ2VudFN0b3JlID0gY2xhc3Mge1xuICBzdGF0aWMgaW5pdChnZXQpIHtcbiAgICBnZXREaXZlcmdlbnRTdG9yZSA9IGdldDtcbiAgfVxuICBnZXRQZWVyKCkge1xuICAgIGNvbnN0IHsgcGVlciB9ID0gZ2V0RGl2ZXJnZW50U3RvcmUoKTtcbiAgICBpZiAoIXBlZXIpIHtcbiAgICAgIGxvZ2dlcl9kZWZhdWx0LmVycm9yKHtcbiAgICAgICAgbWVzc2FnZTogXCJwZWVyIGlzIG5vdCBzZXRcIixcbiAgICAgICAgbWV0YTogeyBwZWVyIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICByZXR1cm4gcGVlcjtcbiAgfVxuICBlbmFibGVBdWRpb1N0cmVhbSgpIHtcbiAgICByZXR1cm4gX19hc3luYyh0aGlzLCBudWxsLCBmdW5jdGlvbiogKCkge1xuICAgICAgY29uc3QgeyBlbmFibGVBdWRpb1N0cmVhbSB9ID0gZ2V0RGl2ZXJnZW50U3RvcmUoKTtcbiAgICAgIHlpZWxkIGVuYWJsZUF1ZGlvU3RyZWFtKCk7XG4gICAgfSk7XG4gIH1cbiAgZGlzYWJsZUF1ZGlvU3RyZWFtKCkge1xuICAgIHJldHVybiBfX2FzeW5jKHRoaXMsIG51bGwsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICBjb25zdCB7IHBhdXNlQXVkaW9UcmFja3MgfSA9IGdldERpdmVyZ2VudFN0b3JlKCk7XG4gICAgICB5aWVsZCBwYXVzZUF1ZGlvVHJhY2tzKCk7XG4gICAgfSk7XG4gIH1cbiAgZ2V0VXNlcigpIHtcbiAgICBjb25zdCB7IHVzZXIgfSA9IGdldERpdmVyZ2VudFN0b3JlKCk7XG4gICAgcmV0dXJuIHVzZXI7XG4gIH1cbiAgZ2V0TWljU3RyZWFtKCkge1xuICAgIGNvbnN0IHsgbWljU3RhdGUgfSA9IGdldERpdmVyZ2VudFN0b3JlKCk7XG4gICAgaWYgKCFtaWNTdGF0ZS5zdHJlYW0pIHtcbiAgICAgIGxvZ2dlcl9kZWZhdWx0LmVycm9yKHtcbiAgICAgICAgbWVzc2FnZTogXCJtaWMgc3RyZWFtIGlzIG5vdCBzZXRcIixcbiAgICAgICAgbWV0YTogeyBtaWNTdGF0ZSB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmV0dXJuIG1pY1N0YXRlLnN0cmVhbTtcbiAgfVxuICBnZXRDYWxsZXJTaWduYWwoKSB7XG4gICAgY29uc3QgeyBjYWxsZXJTaWduYWwgfSA9IGdldERpdmVyZ2VudFN0b3JlKCk7XG4gICAgcmV0dXJuIGNhbGxlclNpZ25hbDtcbiAgfVxuICBnZXRDYWxsZXJVaWQoKSB7XG4gICAgY29uc3QgeyBjYWxsZXJVaWQgfSA9IGdldERpdmVyZ2VudFN0b3JlKCk7XG4gICAgcmV0dXJuIGNhbGxlclVpZDtcbiAgfVxuICBzZXRVc2VyKHVzZXIpIHtcbiAgICBjb25zdCB7IHNldFVzZXIgfSA9IGdldERpdmVyZ2VudFN0b3JlKCk7XG4gICAgc2V0VXNlcih1c2VyKTtcbiAgfVxuICBzZXRDYWxsZXJVaWQodWlkKSB7XG4gICAgY29uc3QgeyBzZXRDYWxsZXJVaWQgfSA9IGdldERpdmVyZ2VudFN0b3JlKCk7XG4gICAgc2V0Q2FsbGVyVWlkKHVpZCk7XG4gIH1cbiAgc2V0UGVlcihwZWVyKSB7XG4gICAgY29uc3QgeyBzZXRQZWVyIH0gPSBnZXREaXZlcmdlbnRTdG9yZSgpO1xuICAgIHNldFBlZXIocGVlcik7XG4gIH1cbiAgc2V0Q2FsbGVyU2lnbmFsKHNpZ25hbCkge1xuICAgIGNvbnN0IHsgc2V0Q2FsbGVyU2lnbmFsIH0gPSBnZXREaXZlcmdlbnRTdG9yZSgpO1xuICAgIHNldENhbGxlclNpZ25hbChzaWduYWwpO1xuICB9XG4gIHNldENhbGxlclN0cmVhbShzdHJlYW0pIHtcbiAgICBjb25zdCB7IHNldENhbGxlclN0cmVhbSB9ID0gZ2V0RGl2ZXJnZW50U3RvcmUoKTtcbiAgICBzZXRDYWxsZXJTdHJlYW0oc3RyZWFtKTtcbiAgfVxuICBzZXRDb25uZWN0aW9uKHBlZXIpIHtcbiAgICBjb25zdCB7IHNldENvbm5lY3Rpb24gfSA9IGdldERpdmVyZ2VudFN0b3JlKCk7XG4gICAgc2V0Q29ubmVjdGlvbihwZWVyKTtcbiAgfVxuICBzZXRFcnJvcih0eXBlLCBtc2cpIHtcbiAgICBjb25zdCB7IHNldEVycm9yIH0gPSBnZXREaXZlcmdlbnRTdG9yZSgpO1xuICAgIHNldEVycm9yKHR5cGUsIG1zZyk7XG4gIH1cbiAgcmVzZXRFcnJvcigpIHtcbiAgICBjb25zdCB7IHJlc2V0RXJyb3IgfSA9IGdldERpdmVyZ2VudFN0b3JlKCk7XG4gICAgcmVzZXRFcnJvcigpO1xuICB9XG59O1xudmFyIERpdmVyZ2VudFNvY2tldENsaWVudCA9IGNsYXNzIGV4dGVuZHMgRGl2ZXJnZW50U3RvcmUge1xuICBjb25zdHJ1Y3RvcihycGNFbmRwb2ludCkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5ycGNFbmRwb2ludCA9IHJwY0VuZHBvaW50O1xuICAgIHRoaXMuc29ja2V0ID0gdm9pZCAwO1xuICB9XG59O1xudmFyIERpdmVyZ2VudEFWQ2xpZW50ID0gY2xhc3MgZXh0ZW5kcyBEaXZlcmdlbnRTb2NrZXRDbGllbnQge1xuICBjb25zdHJ1Y3RvcihycGNFbmRwb2ludCkge1xuICAgIHN1cGVyKHJwY0VuZHBvaW50KTtcbiAgICB0aGlzLnN0YXJ0ID0gKCkgPT4gX19hc3luYyh0aGlzLCBudWxsLCBmdW5jdGlvbiogKCkge1xuICAgICAgaWYgKCF0aGlzLnNvY2tldCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKHRoaXMuc29ja2V0KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5zb2NrZXQub24oXCJ1cGRhdGUtcGVlclwiLCAoZGF0YSkgPT4gX19hc3luYyh0aGlzLCBudWxsLCBmdW5jdGlvbiogKCkge1xuICAgICAgICBsb2dnZXJfZGVmYXVsdC5pbmZvKHtcbiAgICAgICAgICBsb2dUeXBlOiBgdXBkYXRlLXBlZXJgLFxuICAgICAgICAgIG1lc3NhZ2U6IGBVcGRhdGluZyBwZWVyfWAsXG4gICAgICAgICAgbWV0YTogSlNPTi5zdHJpbmdpZnkoZGF0YSlcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0VXNlcihkYXRhKTtcbiAgICAgIH0pKTtcbiAgICAgIHRoaXMuc29ja2V0Lm9uKFwiY2FsbFwiLCAoZGF0YSkgPT4ge1xuICAgICAgICBsb2dnZXJfZGVmYXVsdC5pbmZvKHtcbiAgICAgICAgICB0eXBlOiBgY2FsbC11c2VyYCxcbiAgICAgICAgICBtZXNzYWdlOiBgUmVjZWl2aW5nIGNhbGxgLFxuICAgICAgICAgIG1ldGE6IHtcbiAgICAgICAgICAgIGZyb206IGRhdGEuZnJvbVVpZCxcbiAgICAgICAgICAgIHRvOiB0aGlzLmdldFVzZXIoKS51aWRcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnNldENhbGxlclVpZChkYXRhLmZyb21VaWQpO1xuICAgICAgICB0aGlzLnNldENhbGxlclNpZ25hbChkYXRhLnNpZ25hbCk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuc29ja2V0Lm9uKFwiZW5kLWNhbGxcIiwgKCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkVORElORyBDQUxMXCIpO1xuICAgICAgICB0aGlzLnNldENvbm5lY3Rpb24obnVsbCk7XG4gICAgICAgIHRoaXMuc2V0UGVlcihudWxsKTtcbiAgICAgICAgdGhpcy5zZXRDYWxsZXJVaWQoXCJcIik7XG4gICAgICAgIHRoaXMuc2V0Q2FsbGVyU2lnbmFsKG51bGwpO1xuICAgICAgICB0aGlzLnNldENhbGxlclN0cmVhbShudWxsKTtcbiAgICAgICAgdGhpcy5kaXNhYmxlQXVkaW9TdHJlYW0oKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5zb2NrZXQub24oXCJlcnJvclwiLCAoZGF0YSkgPT4ge1xuICAgICAgICB0aGlzLnNldEVycm9yKGRhdGEudHlwZSwgZGF0YS5tc2cpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgdGhpcy5fZ2V0VXNlcktleSA9ICh1aWQsIHR5cGUpID0+IHtcbiAgICAgIGNvbnN0IG9wdHMgPSB7XG4gICAgICAgIHB1YmxpY0tleTogKHVpZDIpID0+IF9fYXN5bmModGhpcywgbnVsbCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICBjb25zdCBycGNSZXNwb25zZSA9IHlpZWxkIGF4aW9zMi5nZXQoXG4gICAgICAgICAgICBgJHt0aGlzLnJwY0VuZHBvaW50fS9wdWJsaWMta2V5LyR7dWlkMn1gXG4gICAgICAgICAgKTtcbiAgICAgICAgICByZXR1cm4gcnBjUmVzcG9uc2UuZGF0YS5wdWJsaWNLZXk7XG4gICAgICAgIH0pLFxuICAgICAgICBzZWNyZXRLZXk6ICh1aWQyKSA9PiBfX2FzeW5jKHRoaXMsIG51bGwsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHByb3ZpZGVyID0gbmV3IGV0aGVycy5wcm92aWRlcnMuV2ViM1Byb3ZpZGVyKFxuICAgICAgICAgICAgICB3aW5kb3cuZXRoZXJldW1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB5aWVsZCBwcm92aWRlci5zZW5kKFwiZXRoX3JlcXVlc3RBY2NvdW50c1wiLCBbXSk7XG4gICAgICAgICAgICBjb25zdCBzaWduZXIgPSB5aWVsZCBwcm92aWRlci5nZXRTaWduZXIoKTtcbiAgICAgICAgICAgIGNvbnN0IHdhbGxldEFkZHJlc3MgPSB5aWVsZCBzaWduZXIuZ2V0QWRkcmVzcygpO1xuICAgICAgICAgICAgY29uc3QgcnBjUmVzcG9uc2UxID0geWllbGQgYXhpb3MyLmdldChcbiAgICAgICAgICAgICAgYCR7dGhpcy5ycGNFbmRwb2ludH0vc2VjcmV0LWtleS8ke3VpZDJ9YFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IGVuY3J5cHRlZFNlY3JldEtleSA9IHJwY1Jlc3BvbnNlMS5kYXRhLnNlY3JldEtleTtcbiAgICAgICAgICAgIGNvbnN0IHNpZ25hdHVyZU1lc3NhZ2VGb3JJZGVudGl0eUtleSA9IGBSZXF1ZXN0aW5nIHRvIGFjY2VzcyB5b3VyIElkZW50aXR5IEtleS4gTm9uY2U6ICR7eWllbGQgdmVybmVyX2RlZmF1bHQuZ2VuZXJhdGVOb25jZSgpfWA7XG4gICAgICAgICAgICBjb25zdCBpZGVudGl0eVNpZ25hdHVyZSA9IHlpZWxkIHNpZ25lci5zaWduTWVzc2FnZShcbiAgICAgICAgICAgICAgc2lnbmF0dXJlTWVzc2FnZUZvcklkZW50aXR5S2V5XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc3QgcnBjUmVzcG9uc2UyID0geWllbGQgYXhpb3MyLmdldChcbiAgICAgICAgICAgICAgdWlkMiA9PSB3YWxsZXRBZGRyZXNzID8gYCR7dGhpcy5ycGNFbmRwb2ludH0vaWRlbnRpdHkta2V5LyR7d2FsbGV0QWRkcmVzc30/c2lnbmF0dXJlPSR7aWRlbnRpdHlTaWduYXR1cmV9JnNpZ25hdHVyZU1lc3NhZ2U9JHtzaWduYXR1cmVNZXNzYWdlRm9ySWRlbnRpdHlLZXl9YCA6IGAke3RoaXMucnBjRW5kcG9pbnR9L2lkZW50aXR5LWtleS8ke3dhbGxldEFkZHJlc3N9P3NpZ25hdHVyZT0ke2lkZW50aXR5U2lnbmF0dXJlfSZzaWduYXR1cmVNZXNzYWdlPSR7c2lnbmF0dXJlTWVzc2FnZUZvcklkZW50aXR5S2V5fSZ1aWQ9JHt1aWQyfWBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCBpZGVudGl0eUtleSA9IHJwY1Jlc3BvbnNlMi5kYXRhLmlkZW50aXR5S2V5O1xuICAgICAgICAgICAgY29uc3Qgc2lnbmF0dXJlID0geWllbGQgc2lnbmVyLnNpZ25NZXNzYWdlKFxuICAgICAgICAgICAgICBgRW5hYmxlIGlkZW50aXR5IG9uIERpdmVyZ2VudDogJHtpZGVudGl0eUtleX1gXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc3Qgc2VjcmV0S2V5ID0geWllbGQgS01TVXRpbHNfZGVmYXVsdC5hZXNHY21EZWNyeXB0KFxuICAgICAgICAgICAgICBlbmNyeXB0ZWRTZWNyZXRLZXksXG4gICAgICAgICAgICAgIHNpZ25hdHVyZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybiBzZWNyZXRLZXk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdGhpcy5zZXRFcnJvcihcbiAgICAgICAgICAgICAgXCJzaWduUmVqZWN0ZWRcIixcbiAgICAgICAgICAgICAgXCJVc2VyIGhhcyByZWplY3RlZCB0byBwcm92aWRlIHRoZSBzaWduYXR1cmUuXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfTtcbiAgICAgIHJldHVybiBvcHRzW3R5cGVdKHVpZCk7XG4gICAgfTtcbiAgICB0aGlzLl9sb2dpbldpdGhXYWxsZXQgPSAoKSA9PiBfX2FzeW5jKHRoaXMsIG51bGwsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBwcm92aWRlciA9IG5ldyBldGhlcnMucHJvdmlkZXJzLldlYjNQcm92aWRlcihcbiAgICAgICAgICB3aW5kb3cuZXRoZXJldW1cbiAgICAgICAgKTtcbiAgICAgICAgeWllbGQgcHJvdmlkZXIuc2VuZChcImV0aF9yZXF1ZXN0QWNjb3VudHNcIiwgW10pO1xuICAgICAgICBjb25zdCBzaWduZXIgPSB5aWVsZCBwcm92aWRlci5nZXRTaWduZXIoKTtcbiAgICAgICAgY29uc3Qgd2FsbGV0QWRkcmVzcyA9IHlpZWxkIHNpZ25lci5nZXRBZGRyZXNzKCk7XG4gICAgICAgIGNvbnN0IHNpZ25NZXNzYWdlID0geWllbGQgd2FsbGV0QXV0aC5fZ2VuZXJhdGVTaWduYXR1cmVNZXNzYWdlKFxuICAgICAgICAgIHdhbGxldEFkZHJlc3NcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3Qgc2lnbmF0dXJlID0geWllbGQgc2lnbmVyLnNpZ25NZXNzYWdlKHNpZ25NZXNzYWdlKTtcbiAgICAgICAgeWllbGQgdGhpcy5faGFuZGxlQXV0aCh3YWxsZXRBZGRyZXNzLCBzaWduTWVzc2FnZSwgc2lnbmF0dXJlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB0aGlzLnNldEVycm9yKFxuICAgICAgICAgIFwic2lnblJlamVjdGVkXCIsXG4gICAgICAgICAgXCJVc2VyIGhhcyByZWplY3RlZCB0byBwcm92aWRlIHRoZSBzaWduYXR1cmUuXCJcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLl9sb2dpbldpdGhMZW5zID0gKCkgPT4gX19hc3luYyh0aGlzLCBudWxsLCBmdW5jdGlvbiogKCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgZXRoZXJzLnByb3ZpZGVycy5XZWIzUHJvdmlkZXIoXG4gICAgICAgICAgd2luZG93LmV0aGVyZXVtXG4gICAgICAgICk7XG4gICAgICAgIHlpZWxkIHByb3ZpZGVyLnNlbmQoXCJldGhfcmVxdWVzdEFjY291bnRzXCIsIFtdKTtcbiAgICAgICAgY29uc3Qgc2lnbmVyID0geWllbGQgcHJvdmlkZXIuZ2V0U2lnbmVyKCk7XG4gICAgICAgIGNvbnN0IHdhbGxldEFkZHJlc3MgPSB5aWVsZCBzaWduZXIuZ2V0QWRkcmVzcygpO1xuICAgICAgICBjb25zdCBzaWduYXR1cmVNZXNzYWdlID0geWllbGQgbGVuc0F1dGguZ2V0U2lnbmF0dXJlTWVzc2FnZShcbiAgICAgICAgICB3YWxsZXRBZGRyZXNzXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IHlpZWxkIHNpZ25lci5zaWduTWVzc2FnZShzaWduYXR1cmVNZXNzYWdlKTtcbiAgICAgICAgY29uc3QgdG9rZW5zID0geWllbGQgbGVuc0F1dGguZ2V0VG9rZW5zKHdhbGxldEFkZHJlc3MsIHNpZ25hdHVyZSk7XG4gICAgICAgIGNvbnN0IHVpZCA9IHlpZWxkIGxlbnNBdXRoLmdldEhhbmRsZSh3YWxsZXRBZGRyZXNzKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXG4gICAgICAgICAgXCJsZW5zQWNjZXNzVG9rZW5cIixcbiAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBhY2Nlc3NUb2tlbjogdG9rZW5zLmxlbnNBY2Nlc3NUb2tlbixcbiAgICAgICAgICAgIHJlZnJlc2hUb2tlbjogdG9rZW5zLmxlbnNSZWZyZXNoVG9rZW5cbiAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgICB0aGlzLnNvY2tldCA9IGlvKHRoaXMucnBjRW5kcG9pbnQsIHtcbiAgICAgICAgICBhdXRoOiB7XG4gICAgICAgICAgICB0b2tlbjogdG9rZW5zLmFjY2Vzc1Rva2VuXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zdGFydCgpO1xuICAgICAgICB0aGlzLl9oYW5kbGVLTVNBdXRoKHVpZCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHRoaXMuc2V0RXJyb3IoXG4gICAgICAgICAgXCJzaWduUmVqZWN0ZWRcIixcbiAgICAgICAgICBcIlVzZXIgaGFzIHJlamVjdGVkIHRvIHByb3ZpZGUgdGhlIHNpZ25hdHVyZS5cIlxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuX2hhbmRsZUF1dGggPSAodWlkLCBzaWduTWVzc2FnZSwgc2lnbmF0dXJlKSA9PiBfX2FzeW5jKHRoaXMsIG51bGwsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICBjb25zdCB0b2tlbnMgPSB5aWVsZCB3YWxsZXRBdXRoLnZlcmlmeVNpZ25hdHVyZShcbiAgICAgICAgdWlkLFxuICAgICAgICBzaWduTWVzc2FnZSxcbiAgICAgICAgc2lnbmF0dXJlXG4gICAgICApO1xuICAgICAgdGhpcy5zb2NrZXQgPSBpbyh0aGlzLnJwY0VuZHBvaW50LCB7XG4gICAgICAgIGF1dGg6IHtcbiAgICAgICAgICB0b2tlbjogdG9rZW5zLmFjY2Vzc1Rva2VuXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgdGhpcy5zdGFydCgpO1xuICAgICAgdGhpcy5faGFuZGxlS01TQXV0aCh1aWQpO1xuICAgIH0pO1xuICAgIHRoaXMuX2hhbmRsZUtNU0F1dGggPSAodWlkKSA9PiBfX2FzeW5jKHRoaXMsIG51bGwsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBycGNSZXNwb25zZSA9IHlpZWxkIGF4aW9zMi5nZXQoYCR7dGhpcy5ycGNFbmRwb2ludH0vJHt1aWR9YCk7XG4gICAgICAgIGlmICghcnBjUmVzcG9uc2UuZGF0YS5leGlzdHMpIHtcbiAgICAgICAgICBjb25zdCBpZGVudGl0eUtleSA9IHlpZWxkIEtNU1V0aWxzX2RlZmF1bHQuZ2VuZXJhdGVJZGVudGl0eUtleSgpO1xuICAgICAgICAgIGNvbnN0IHByb3ZpZGVyID0gbmV3IGV0aGVycy5wcm92aWRlcnMuV2ViM1Byb3ZpZGVyKFxuICAgICAgICAgICAgd2luZG93LmV0aGVyZXVtXG4gICAgICAgICAgKTtcbiAgICAgICAgICB5aWVsZCBwcm92aWRlci5zZW5kKFwiZXRoX3JlcXVlc3RBY2NvdW50c1wiLCBbXSk7XG4gICAgICAgICAgY29uc3Qgc2lnbmVyID0geWllbGQgcHJvdmlkZXIuZ2V0U2lnbmVyKCk7XG4gICAgICAgICAgY29uc3Qgc2lnbmF0dXJlID0geWllbGQgc2lnbmVyLnNpZ25NZXNzYWdlKFxuICAgICAgICAgICAgYEVuYWJsZSBpZGVudGl0eSBvbiBEaXZlcmdlbnQ6ICR7aWRlbnRpdHlLZXl9YFxuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc3Qga2V5cyA9IHlpZWxkIHZlcm5lcl9kZWZhdWx0LmdlbmVyYXRlS2V5cyh1aWQpO1xuICAgICAgICAgIGNvbnN0IGVuY3J5cHRlZFNlY3JldEtleSA9IHlpZWxkIEtNU1V0aWxzX2RlZmF1bHQuYWVzR2NtRW5jcnlwdChcbiAgICAgICAgICAgIGtleXMuc2VjcmV0S2V5LFxuICAgICAgICAgICAgc2lnbmF0dXJlXG4gICAgICAgICAgKTtcbiAgICAgICAgICB0aGlzLnNlY3JldEtleSA9IGtleXMuc2VjcmV0S2V5O1xuICAgICAgICAgIHRoaXMucHVibGljS2V5ID0ga2V5cy5wdWJsaWNLZXk7XG4gICAgICAgICAgdGhpcy5zb2NrZXQgJiYgdGhpcy5zb2NrZXQuZW1pdChcIkB1cGRhdGUtcGVlclwiLCB7XG4gICAgICAgICAgICB1aWQsXG4gICAgICAgICAgICBpZDogdGhpcy5zb2NrZXQuaWQsXG4gICAgICAgICAgICB0eXBlOiBcImxvZ2luXCIsXG4gICAgICAgICAgICBpZGVudGl0eUtleSxcbiAgICAgICAgICAgIHB1YmxpY0tleToga2V5cy5wdWJsaWNLZXksXG4gICAgICAgICAgICBzZWNyZXRLZXk6IGVuY3J5cHRlZFNlY3JldEtleVxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuc2VjcmV0S2V5ID0geWllbGQgdGhpcy5fZ2V0VXNlcktleSh1aWQsIFwic2VjcmV0S2V5XCIpO1xuICAgICAgICAgIHRoaXMucHVibGljS2V5ID0geWllbGQgdGhpcy5fZ2V0VXNlcktleSh1aWQsIFwicHVibGljS2V5XCIpO1xuICAgICAgICAgIHRoaXMuc29ja2V0ICYmIHRoaXMuc29ja2V0LmVtaXQoXCJAdXBkYXRlLXBlZXJcIiwge1xuICAgICAgICAgICAgdWlkLFxuICAgICAgICAgICAgaWQ6IHRoaXMuc29ja2V0LmlkLFxuICAgICAgICAgICAgdHlwZTogXCJsb2dpblwiXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgdGhpcy5zZXRFcnJvcihcbiAgICAgICAgICBcInNpZ25SZWplY3RlZFwiLFxuICAgICAgICAgIFwiVXNlciBoYXMgcmVqZWN0ZWQgdG8gcHJvdmlkZSB0aGUgc2lnbmF0dXJlLlwiXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5pbml0ID0gKHR5cGUpID0+IF9fYXN5bmModGhpcywgbnVsbCwgZnVuY3Rpb24qICgpIHtcbiAgICAgIGxvZ2dlcl9kZWZhdWx0LmluZm8oe1xuICAgICAgICB0eXBlOiBcImxvZ2luXCIsXG4gICAgICAgIG1lc3NhZ2U6IFwiTG9nZ2luZyBpbiB1c2VyXCJcbiAgICAgIH0pO1xuICAgICAgaWYgKHR5cGUgPT0gXCJ3YWxsZXRcIilcbiAgICAgICAgeWllbGQgdGhpcy5fbG9naW5XaXRoV2FsbGV0KCk7XG4gICAgICBlbHNlIGlmICh0eXBlID09IFwibGVuc1wiKVxuICAgICAgICB5aWVsZCB0aGlzLl9sb2dpbldpdGhMZW5zKCk7XG4gICAgICBlbHNlXG4gICAgICAgIHRoaXMuX2xvZ2luV2l0aFdhbGxldCgpO1xuICAgICAgcmV0dXJuO1xuICAgIH0pO1xuICAgIHRoaXMuZGlhbCA9ICh0b0lkKSA9PiBfX2FzeW5jKHRoaXMsIG51bGwsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICB0cnkge1xuICAgICAgICBsb2dnZXJfZGVmYXVsdC5pbmZvKHtcbiAgICAgICAgICB0eXBlOiBgZGlhbGAsXG4gICAgICAgICAgbWVzc2FnZTogYERpYWxpbmcgdG8gYSB1c2VyYCxcbiAgICAgICAgICBtZXRhOiB7XG4gICAgICAgICAgICB0bzogdG9JZCxcbiAgICAgICAgICAgIGZyb206IHRoaXMuZ2V0VXNlcigpLnVpZFxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0Q2FsbGVyVWlkKHRvSWQpO1xuICAgICAgICB5aWVsZCB0aGlzLmVuYWJsZUF1ZGlvU3RyZWFtKCk7XG4gICAgICAgIGNvbnN0IHBlZXIgPSBuZXcgUGVlcih7XG4gICAgICAgICAgaW5pdGlhdG9yOiB0cnVlLFxuICAgICAgICAgIHRyaWNrbGU6IGZhbHNlLFxuICAgICAgICAgIHN0cmVhbTogdGhpcy5nZXRNaWNTdHJlYW0oKSA/IHRoaXMuZ2V0TWljU3RyZWFtKCkgOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0UGVlcihwZWVyKTtcbiAgICAgICAgcGVlci5vbihcInNpZ25hbFwiLCAoZGF0YSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHVzZXIgPSB0aGlzLmdldFVzZXIoKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyh1c2VyKTtcbiAgICAgICAgICBpZiAoIXRoaXMuc29ja2V0KVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIHRoaXMuc29ja2V0LmVtaXQoXCJAY2FsbFwiLCB7XG4gICAgICAgICAgICBwZWVyVG9DYWxsOiB0b0lkLFxuICAgICAgICAgICAgc2lnbmFsRGF0YTogZGF0YSxcbiAgICAgICAgICAgIGZyb206IHVzZXIudWlkXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBwZWVyLm9uKFwic3RyZWFtXCIsIChzdHJlYW0pID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhzdHJlYW0pO1xuICAgICAgICAgIHRoaXMuc2V0Q2FsbGVyU3RyZWFtKHN0cmVhbSk7XG4gICAgICAgIH0pO1xuICAgICAgICBwZWVyLm9uKFwiZGF0YVwiLCAoZGF0YSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGRlY29kZWREYXRhID0gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGRhdGEpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGRlY29kZWREYXRhKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZ2V0UGVlcigpKTtcbiAgICAgICAgaWYgKCF0aGlzLnNvY2tldClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMuc29ja2V0Lm9uKFwiYW5zd2VyXCIsIChzaWduYWwpID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIkNBTEwgQUNDRVBURURcIiwgc2lnbmFsKTtcbiAgICAgICAgICBwZWVyLnNpZ25hbChzaWduYWwpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZXRDb25uZWN0aW9uKHBlZXIpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2dnZXJfZGVmYXVsdC5lcnJvcih7XG4gICAgICAgICAgdHlwZTogYGRpYWwtZXJyb3JgLFxuICAgICAgICAgIG1lc3NhZ2U6IGBVbmFibGUgdG8gZGlhbCB0byB1c2VyYCxcbiAgICAgICAgICBtZXRhOiBKU09OLnN0cmluZ2lmeShlKVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGU7XG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5hbnN3ZXIgPSAoKSA9PiBfX2FzeW5jKHRoaXMsIG51bGwsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICB0cnkge1xuICAgICAgICBsb2dnZXJfZGVmYXVsdC5pbmZvKHtcbiAgICAgICAgICB0eXBlOiBgYW5zd2VyYCxcbiAgICAgICAgICBtZXNzYWdpbmc6IGBBbnN3ZXJpbmcgY2FsbGBcbiAgICAgICAgfSk7XG4gICAgICAgIHlpZWxkIHRoaXMuZW5hYmxlQXVkaW9TdHJlYW0oKTtcbiAgICAgICAgY29uc3QgcGVlciA9IG5ldyBQZWVyKHtcbiAgICAgICAgICBpbml0aWF0b3I6IGZhbHNlLFxuICAgICAgICAgIHRyaWNrbGU6IGZhbHNlLFxuICAgICAgICAgIHN0cmVhbTogdGhpcy5nZXRNaWNTdHJlYW0oKSA/IHRoaXMuZ2V0TWljU3RyZWFtKCkgOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0UGVlcihwZWVyKTtcbiAgICAgICAgcGVlci5vbihcInNpZ25hbFwiLCAoZGF0YSkgPT4ge1xuICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAoX2EgPSB0aGlzLnNvY2tldCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmVtaXQoXCJAYW5zd2VyXCIsIHtcbiAgICAgICAgICAgIHNpZ25hbDogZGF0YSxcbiAgICAgICAgICAgIHRvOiB0aGlzLmdldENhbGxlclVpZCgpXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBwZWVyLm9uKFwic3RyZWFtXCIsIChzdHJlYW0pID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhzdHJlYW0pO1xuICAgICAgICAgIHRoaXMuc2V0Q2FsbGVyU3RyZWFtKHN0cmVhbSk7XG4gICAgICAgIH0pO1xuICAgICAgICBwZWVyLnNpZ25hbCh0aGlzLmdldENhbGxlclNpZ25hbCgpKTtcbiAgICAgICAgdGhpcy5zZXRDb25uZWN0aW9uKHBlZXIpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2dnZXJfZGVmYXVsdC5lcnJvcih7XG4gICAgICAgICAgdHlwZTogYGFuc3dlci1lcnJvcmAsXG4gICAgICAgICAgbWVzc2FnaW5nOiBgRmFpbGVkIHRvIGFuc3dlciBjYWxsYCxcbiAgICAgICAgICBtZXRhOiBKU09OLnN0cmluZ2lmeShlKVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGU7XG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5lbmQgPSAoKSA9PiB7XG4gICAgICB2YXIgX2E7XG4gICAgICAoX2EgPSB0aGlzLnNvY2tldCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmVtaXQoXCJAZW5kXCIsIHsgcGVlclRvRW5kOiB0aGlzLmdldENhbGxlclVpZCgpIH0pO1xuICAgICAgdGhpcy5zZXRDb25uZWN0aW9uKG51bGwpO1xuICAgICAgdGhpcy5zZXRQZWVyKG51bGwpO1xuICAgICAgdGhpcy5zZXRDYWxsZXJVaWQoXCJcIik7XG4gICAgICB0aGlzLnNldENhbGxlclNpZ25hbChudWxsKTtcbiAgICAgIHRoaXMuc2V0Q2FsbGVyU3RyZWFtKG51bGwpO1xuICAgICAgdGhpcy5kaXNhYmxlQXVkaW9TdHJlYW0oKTtcbiAgICB9O1xuICAgIHRoaXMucmV2ZWFsS2V5cyA9ICgpID0+IF9fYXN5bmModGhpcywgbnVsbCwgZnVuY3Rpb24qICgpIHtcbiAgICAgIGNvbnN0IHVpZCA9IHRoaXMuZ2V0VXNlcigpLnVpZDtcbiAgICAgIGNvbnN0IHB1YmxpY0tleSA9IHlpZWxkIHRoaXMuX2dldFVzZXJLZXkodWlkLCBcInB1YmxpY0tleVwiKTtcbiAgICAgIGNvbnN0IHNlY3JldEtleSA9IHlpZWxkIHRoaXMuX2dldFVzZXJLZXkodWlkLCBcInNlY3JldEtleVwiKTtcbiAgICAgIGNvbnN0IGtleXMgPSB7IHB1YmxpY0tleSwgc2VjcmV0S2V5IH07XG4gICAgICByZXR1cm4ga2V5cztcbiAgICB9KTtcbiAgfVxufTtcbnZhciBEaXZlcmdlbnRBVkNsaWVudF9kZWZhdWx0ID0gRGl2ZXJnZW50QVZDbGllbnQ7XG5cbi8vIHNyYy9EaXZlcmdlbnRBVkNsaWVudC9pbmRleC50c3hcbnZhciBEaXZlcmdlbnRBVkNsaWVudFByb3ZpZGVyID0gKHsgY2hpbGRyZW4sIHZhbHVlIH0pID0+IHtcbiAgY29uc3QgeyBnZXRTdGF0ZTogZ2V0U3RhdGUyIH0gPSB1c2VSb290U3RvcmVfZGVmYXVsdDtcbiAgRGl2ZXJnZW50QVZDbGllbnRfZGVmYXVsdC5pbml0KGdldFN0YXRlMik7XG4gIHJldHVybiAvKiBAX19QVVJFX18gKi8gUmVhY3QuY3JlYXRlRWxlbWVudChEaXZlcmdlbnRBVkNsaWVudENvbnRleHQuUHJvdmlkZXIsIHsgdmFsdWUgfSwgXCIgXCIsIGNoaWxkcmVuLCBcIiBcIik7XG59O1xudmFyIERpdmVyZ2VudEFWQ2xpZW50X2RlZmF1bHQyID0gRGl2ZXJnZW50QVZDbGllbnRQcm92aWRlcjtcblxuLy8gc3JjL2hvb2tzL2luZGV4LnRzXG5pbXBvcnQgeyB1c2VDb250ZXh0IH0gZnJvbSBcInJlYWN0XCI7XG52YXIgdXNlRGl2ZXJnZW50QVZDbGllbnQgPSAoKSA9PiB1c2VDb250ZXh0KERpdmVyZ2VudEFWQ2xpZW50Q29udGV4dCk7XG5cbi8vIHNyYy9EaXZlcmdlbnRBVkNsaWVudC9oYy50c1xudmFyIGRjO1xudmFyIGNyZWF0ZURpdmVyZ2VudEFWQ2xpZW50ID0gKHJwY0VuZHBvaW50KSA9PiB7XG4gIGRjID0gbmV3IERpdmVyZ2VudEFWQ2xpZW50X2RlZmF1bHQocnBjRW5kcG9pbnQpO1xuICByZXR1cm4gZGM7XG59O1xudmFyIGdldERpdmVyZ2VudEFWQ2xpZW50ID0gKHJwY0VuZHBvaW50KSA9PiB7XG4gIGlmICghZGMgJiYgcnBjRW5kcG9pbnQpXG4gICAgY3JlYXRlRGl2ZXJnZW50QVZDbGllbnQocnBjRW5kcG9pbnQpO1xuICByZXR1cm4gZGM7XG59O1xuZXhwb3J0IHtcbiAgRGl2ZXJnZW50QVZDbGllbnRfZGVmYXVsdDIgYXMgRGl2ZXJnZW50QVZDbGllbnRQcm92aWRlcixcbiAgY3JlYXRlRGl2ZXJnZW50QVZDbGllbnQsXG4gIGdldERpdmVyZ2VudEFWQ2xpZW50LFxuICB1c2VEaXZlcmdlbnRBVkNsaWVudCxcbiAgdXNlUm9vdFN0b3JlX2RlZmF1bHQgYXMgdXNlRGl2ZXJnZW50U3RvcmVcbn07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/@huddle01/divergent-av/dist/index.mjs\n"));

/***/ })

});